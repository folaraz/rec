<!DOCTYPE html>
<!-- saved from url=(0051)https://www.kaggle.com/colinmorris/embedding-layers -->
<html lang="en" class="gr__kaggle_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Embedding Layers | Kaggle</title>
    
    <meta name="robots" content="index, follow">
    <meta name="description" content="Download Open Datasets on 1000s of Projects + Share Projects on One Platform. Explore Popular Topics Like Government, Sports, Medicine, Fintech, Food, More. Flexible Data Ingestion.">
    <meta name="turbolinks-cache-control" content="no-cache">
                <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0">    <meta name="theme-color" content="#008ABC">
    <script type="text/javascript" async="" src="./Embedding Layers _ Kaggle_files/koj6gxx6"></script><script src="./Embedding Layers _ Kaggle_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Embedding Layers _ Kaggle_files/js"></script><script type="text/javascript" async="" src="./Embedding Layers _ Kaggle_files/analytics.js"></script><script src="./Embedding Layers _ Kaggle_files/inferredEvents.js" async=""></script><script src="./Embedding Layers _ Kaggle_files/136809193586742" async=""></script><script async="" src="./Embedding Layers _ Kaggle_files/fbevents.js"></script><script type="text/javascript">
        window["initialPageLoadStartTime"] = new Date().getTime();
    </script>
    <link rel="dns-prefetch" href="https://www.google-analytics.com/"><link rel="dns-prefetch" href="https://stats.g.doubleclick.net/"><link rel="dns-prefetch" href="https://js.intercomcdn.com/"><link rel="dns-prefetch" href="https://storage.googleapis.com/">
    <link href="https://www.kaggle.com/static/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="manifest" href="https://www.kaggle.com/static/json/manifest.json">
    <link href="./Embedding Layers _ Kaggle_files/css" rel="stylesheet" type="text/css">
    <link href="./Embedding Layers _ Kaggle_files/icon" rel="stylesheet" type="text/css">
        <link rel="canonical" href="https://www.kaggle.com/colinmorris/embedding-layers">                    <link rel="stylesheet" type="text/css" href="./Embedding Layers _ Kaggle_files/vendor.css">
        <link rel="stylesheet" type="text/css" href="./Embedding Layers _ Kaggle_files/app.css">
    
    
 
        <script>
        try{(function(a,s,y,n,c,h,i,d,e){d=s.createElement("style");
        d.appendChild(s.createTextNode(""));s.head.appendChild(d);d=d.sheet;
        y=y.map(x => d.insertRule(x + "{ opacity: 0 !important }"));
        h.start=1*new Date;h.end=i=function(){y.forEach(x => x<d.cssRules.length ? d.deleteRule(x) : {})};
        (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
        })(window,document,['.site-header-react__nav'],'dataLayer',2000,{'GTM-52LNT9S':true});}catch{}
    </script><style></style>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-12629138-1', {
            'optimize_id': 'GTM-52LNT9S',
            'displayFeaturesTask': null,
            'send_page_view': false
        });
    </script>
    <script async="" src="./Embedding Layers _ Kaggle_files/js(1)"></script>

    
<script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
    fbq("set", "autoConfig", "false", "136809193586742");
    fbq('init', '136809193586742'); 
    fbq('track', 'PageView');
</script>
<noscript>
    <img height="1" width="1" src="https://www.facebook.com/tr?id=136809193586742&ev=PageView&noscript=1"/>
</noscript>

<script>window.intercomSettings = {"app_id":"koj6gxx6","name":"folaraz","email":"folaraz11@gmail.com","user_hash":"6e641bcd63a7f407245a43915d0f0d46bad08f4d4c67fa5fa2235ff6dbdc3704","created_at":1484494417,"last_visit_date_at":1566162570,"status_id":2,"performance_tier":1,"user_name":"folaraz","display_name":"folaraz","is_admin":false,"experiment_group":1,"newsletter_subscriber":true,"competition_mailing_list_subscriber":true,"block_emails":false,"competitions_tier":1,"competitions_tier_attained_at":1563617594,"kernels_tier":1,"kernels_tier_attained_at":1563617594,"discussion_tier":1,"discussion_tier_attained_at":1563617594,"datasets_count":1,"last_dataset_created_at":1506670801,"last_new_dataset_visit_at":1485705903,"host_page_visits":11,"in_class_competitions_hosted_count":4,"last_hour_searches_count":0,"api_has_token":true,"api_has_requests":false,"api_token_created":1554793611};</script>        <script>(function () { var w = window; var ic = w.Intercom; if (typeof ic === "function") { ic('reattach_activator'); ic('update', intercomSettings); } else { var d = document; var i = function () { i.c(arguments) }; i.q = []; i.c = function (args) { i.q.push(args) }; w.Intercom = i; function l() { var s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = 'https://widget.intercom.io/widget/koj6gxx6'; var x = d.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); } if (w.attachEvent) { w.attachEvent('onload', l); } else { w.addEventListener('load', l, false); } } })()</script>
    
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@kaggledatasets">
    <meta name="og:url" content="https://kaggle.com/colinmorris/embedding-layers">
    <meta name="og:title" content="Embedding Layers">
    <meta name="og:description" content="Using data from MovieLens Preprocessing">
    <meta name="og:image" content="https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg">


    
    

    
    
    
<script type="text/javascript">
    var Kaggle = Kaggle || {};

    Kaggle.Current = {
        userId: 868931,
        userProfileUrl: '/folaraz',
        userDisplayNameEscaped: 'folaraz',
        userThumbnailUrl: 'https://storage.googleapis.com/kaggle-avatars/thumbnails/868931-kg.jpg',
        userEmail: 'folaraz11@gmail.com',
        userIsPhoneVerified: true,
        userName: 'folaraz',
        tier: 'Contributor',
        antiForgeryToken: 'CfDJ8LdUzqlsSWBPr4Ce3rb9VL9M-ve_XbYjPk_M6IhPg1o82fPPEhTEgh6TkLyXigddANkESb1h0zFvysbIXeRX5Ik8h3V3BOqtFeywVc-Yjs0gwqOF-JOABiDiUx5bT9AsfN5NFW4pg9vhwp9zMdqPgstOXVtmayi4v5F9bVjTiF0HyrkzDKpmW5f72Soid6wjVQ',
        isAnonymous: false,
        analyticsToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjYxNjM0NzksIlVzZXJJZCI6ODY4OTMxfQ.wxblgpvidUCq2d-Xp8xob3iHeTNYeTbeHyuKQCzLfXo',
        analyticsTokenExpiry: 15,
        internetKernelsEnabled: true,
        
        
        
        
        
        
        mdeImageUploader: true,
        
        
        
    }
        Kaggle.Current.log = function(){};
        Kaggle.Current.warn = function(){};

    var decodeUserDisplayName = function () {
        var escapedUserDisplayName = Kaggle.Current.userDisplayNameEscaped || "";
        try {
            var textVersion = new DOMParser().parseFromString(escapedUserDisplayName, "text/html").documentElement.textContent;
            if (textVersion) {
                return textVersion;
            }
        } catch(ex) {}
        return escapedUserDisplayName;
    }
    Kaggle.Current.userDisplayName = decodeUserDisplayName();
</script>

    

<script type="text/javascript">
    var Kaggle = Kaggle || {};
    Kaggle.PageMessages = [];
</script>

    
<script type="text/javascript">
/* <![CDATA[ */
goog_snippet_vars = function() {
    var w = window;
    w.google_conversion_id = 955616553;
    w.google_conversion_label = "QSjvCKDksHMQqZrWxwM";
    w.google_conversion_value = 0.00;
    w.google_conversion_currency = "USD";
    w.google_remarketing_only = false;
    w.google_conversion_language = "en";
    w.google_conversion_format = "3";
    w.google_conversion_color = "ffffff";
}
// DO NOT CHANGE THE CODE BELOW.
goog_report_conversion = function(url) {
    goog_snippet_vars();
    window.google_conversion_format = "3";
    var opt = new Object();
    opt.onload_callback = function() {
        if (typeof(url) != 'undefined') {
            window.location = url;
        }
    }
    var conv_handler = window['google_trackConversion'];
    if (typeof(conv_handler) == 'function') {
        conv_handler(opt);
    }
}
/* ]]> */
</script>
<script type="text/javascript" src="./Embedding Layers _ Kaggle_files/f.txt">
</script>



        <script>window['useKaggleAnalytics'] = true;</script>

    <script src="./Embedding Layers _ Kaggle_files/vendor.js" data-turbolinks-track="reload"></script>
    <script src="./Embedding Layers _ Kaggle_files/app.js" data-turbolinks-track="reload"></script><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-1" data-turbolinks-permanent="true"></style><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-2" data-turbolinks-permanent="true"></style><style data-styled="" data-styled-version="4.3.2" id="kaggle-sc-3" data-turbolinks-permanent="true"></style><style data-emotion=""></style>
        <script>
            (function() {
                if ('serviceWorker' in navigator) {
                    navigator.serviceWorker.register("/static/assets/service-worker.js").then(function(reg) {
                        reg.onupdatefound = function() {
                            var installingWorker = reg.installing;
                            installingWorker.onstatechange = function() {
                                switch (installingWorker.state) {
                                case 'installed':
                                    if (navigator.serviceWorker.controller) {
                                        console.log('New or updated content is available.');
                                    } else {
                                        console.log('Content is now available offline!');
                                    }
                                    break;
                                case 'redundant':
                                    console.error('The installing service worker became redundant.');
                                    break;
                                }
                            };
                        };
                    }).catch(function(e) {
                      console.error('Error during service worker registration:', e);
                    });
                }
            })();
        </script>
    <script>
        function handleClientLoad() {
            try {
                gapi.load('client:auth2');
            } catch (e) {
                // In Opera, readystatechange is an unreliable detection of script load, causing
                // this function to be called before gapi exists on the window. The onload callback
                // is still called at the correct time, so the feature works as expected - it's
                // just generating noisy errors.
            }
        }
    </script>
    <script async="" defer="" src="./Embedding Layers _ Kaggle_files/api.js" onload="this.googleApiOnLoad=function(){};handleClientLoad()" onreadystatechange="if (this.readyState === &#39;complete&#39;) this.googleApiOnLoad()" gapi_processed="true">
    </script>
            <script defer="" src="./Embedding Layers _ Kaggle_files/stackdriver-errors-concat.min.js"></script>
        <script type="text/javascript">
            window.addEventListener('DOMContentLoaded', function () {
                var errorHandler = new StackdriverErrorReporter();
                errorHandler.start({
                    key: 'AIzaSyDANGXFHtSIVc51MIdGwg4mQFgm3oNrKoo',
                    projectId: 'kaggle-161607',
                    service: 'web-fe',
                    version: 'a3e6ca76aff7f1d0b82818a853dbc274ddafeec4',
                    context: { user: '868931' }
                });
            });
        </script>
<script charset="utf-8" src="./Embedding Layers _ Kaggle_files/4.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body data-turbolinks="true" data-gr-c-s-loaded="true"><div id="MathJax_Message" style="display: none;"></div>
    <main>
        






<div class="site-layout">
        <div class="site-layout__header">
            <div data-component-name="SiteHeaderContainer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div class="site-header-react"><div class="site-header-react__wrapper-cookies-header"><div class="site-header-react__container"><div class="site-header-react__content"><div class="site-header-react__logo"><a href="https://www.kaggle.com/"><img alt="Kaggle" src="./Embedding Layers _ Kaggle_files/site-logo.png"></a></div><div class="site-header-react__quick-search"><div class="quick-search undefined quick-search--dark false undefined"><div class="quick-search__search-box-container"><input aria-label="Site search" class="quick-search__search-box " type="text" placeholder="Search"><div class="quick-search__button"><i class="fa fa-search"></i></div></div></div></div><nav class="site-header-react__nav"><ol class="SiteHeader_SiteHeaderNavList-sc-fru52l btMbfT"><li class="site-header-react__nav-item site-header-react__nav-item--first"><a id="site-header-competitions__a" href="https://www.kaggle.com/competitions">Competitions</a></li><li class="site-header-react__nav-item "><a id="site-header-datasets__a" href="https://www.kaggle.com/datasets">Datasets</a></li><li class="site-header-react__nav-item "><a id="site-header-notebooks__a" href="https://www.kaggle.com/kernels">Notebooks</a></li><li class="site-header-react__nav-item "><a id="site-header-discussion__a" href="https://www.kaggle.com/discussion">Discussion</a></li><li class="site-header-react__nav-item "><a id="site-header-courses__a" href="https://www.kaggle.com/learn">Courses</a></li><li class="site-header-react__nav-item"><a class="site-header-react__extra-link" title="More"><svg class="site-header-react__nav-ellipsis" width="18px" height="4px" viewBox="0 0 18 4"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M16,4 C14.8954305,4 14,3.1045695 14,2 C14,0.8954305 14.8954305,0 16,0 C17.1045695,0 18,0.8954305 18,2 C18,3.1045695 17.1045695,4 16,4 Z M9,4 C7.8954305,4 7,3.1045695 7,2 C7,0.8954305 7.8954305,0 9,0 C10.1045695,0 11,0.8954305 11,2 C11,3.1045695 10.1045695,4 9,4 Z M2,4 C0.8954305,4 0,3.1045695 0,2 C0,0.8954305 0.8954305,0 2,0 C3.1045695,0 4,0.8954305 4,2 C4,3.1045695 3.1045695,4 2,4 Z" fill="#FFFFFF"></path></g></svg></a></li></ol></nav><div class="NotificationContainer_NotificationContainerWrapper-sc-bb4fan kMXxed"><span class="tooltip-container NotificationContainer_NotificationTooltipWrapper-sc-1jdjwer TZodN" data-tooltip="Notifications"><div class="NotificationIcon_NotificationIconWrapper-sc-3rbk7d dBubSX"><div class="NotificationIcon_NotificationIconIcon-sc-wpy2fb cdXHpW"><span name="bell" class="fa fa-bell"></span></div><div class="NotificationIcon_UnviewedCounterWrapper-sc-qoeqza LJMuf"><div class="NotificationIcon_UnviewedCounterText-sc-ifrp6v bhudHX">1</div></div></div></span><div></div></div><div class="site-header-react__user"><span class="tooltip-container" data-tooltip="Your profile"><div class="site-header-react__user--logged-in"><ul><li class="site-header-react__user-avatar"><img src="./Embedding Layers _ Kaggle_files/868931-kg.jpg"></li></ul></div></span></div></div></div></div></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({});performance && performance.mark && performance.mark("SiteHeaderContainer.componentCouldBootstrap");</script>
        </div>

    <div class="site-layout__main-content">
        

<div data-component-name="KernelViewer" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div><div id="kernel-header-wrapper" class="KernelViewer_HeaderWrapper-sc-ohc1yt sDEXm" style="top: 0px;"><div class="sc-buGlAa crIovC"></div></div><div class="KernelViewer_ViewerContent-sc-c2nrua fxgEVS"><div class="kernel-viewer"><span class="KernelViewer_NavigationSidebarWrapper-sc-56cp8f jJbHsV"><div class="KernelViewerContext_FullNavigationMenu-sc-1n0pzuj KernelViewerContext_LinklessNavigationMenu-sc-1hmbdku haBfAe"><div class="navbox__container"><div class="navbox__nav-wrapper"><nav class="navbox__nav"><a class="navbox__nav-item--selected" href="https://www.kaggle.com/colinmorris/embedding-layers/notebook" title="Notebook">Notebook</a><div class="navbox__page"><span class="KernelViewerContext_ContentsMenu-sc-8en2wv igjpFC"><div class="navbox__container"><div class="navbox__nav-wrapper"><nav class="navbox__nav"><a class="navbox__nav-item--selected-with-bar" href="https://www.kaggle.com/colinmorris/embedding-layers#Sparse-Categorical-Variables" title="">Sparse Categorical Variables</a><div class="navbox__page"></div><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers#MovieLens" title="">MovieLens</a><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers#Building-a-rating-prediction-model-in-Keras" title="">Building a rating prediction model in Keras</a><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers#Your-turn!" title="">Your turn!</a></nav></div></div></span></div><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers/data" title="Data">Data</a><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers/output" title="Output">Output</a><a class="navbox__nav-item" href="https://www.kaggle.com/colinmorris/embedding-layers/comments" title="Comments">Comments</a></nav></div></div></div></span><div class="kernel-viewer__container"><div class="kernel-viewer__pane-container" id="kernel-viewer__pane-container"><div id="notebook"><div><div class="kernel-notebook-pane" style="display: block;"><div class="content-box"><div><div class="content-box__title-bar"><div class="ContentBox_Title-sc-6fbrxj iCvEyH" style="line-height: 46px;">Notebook</div></div></div><div class="content-box__content-section"><div class="kernel-notebook-pane__container"><iframe id="rendered-kernel-content" src="./Embedding Layers _ Kaggle_files/__results__.html" scrolling="no" title="Main Kernel Content" style="height: 12401px; display: block;"></iframe><div class="kernel-notebook-pane__loading" style="display: none;"><div class="Spinner_SpinnerContainer-sc-fllvzl cBVAFE"><i class="fa fa-circle-o-notch fa-spin fa-2x"></i></div></div></div></div></div></div><div class="kernel-code-pane__subtitle" id="notebook-pane-license-info">This kernel has been released under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a> open source license.</div><div class="upvote-suggestion upvote-suggestion__kernel"><div class="upvote-suggestion__text"><div class="upvote-suggestion__main-text">Did you find this Kernel useful?</div><div class="upvote-suggestion__sub-text">Show your appreciation with an upvote</div></div><div class="upvote-suggestion__button"><div class="vote-button__container "><div class="vote-button vote-button--enabled"><div class="vote-button__button vote-button__button--up vb-upvote"><span class="fa fa-caret-up"></span></div><div class="vote-button__button vote-button__button--up vote-button__vote-count-container"><span class="vote-button__vote-count">122</span></div><div class="vote-button__button-placeholder"></div></div></div></div><div class="upvote-suggestion__voters"><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="தீனதயாளன் சந்திரகுமாரன் / Deenadayalan C" data-tooltip-size="small"><a href="https://www.kaggle.com/deenadayalan" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/27886-gp.jpg" alt="தீனதயாளன் சந்திரகுமாரன் / Deenadayalan C" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="AK Huang" data-tooltip-size="small"><a href="https://www.kaggle.com/astrokuang" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/64870-gr.jpg" alt="AK Huang" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-top"><span class="tooltip-container" data-tooltip="jroberayalas" data-tooltip-size="small"><a href="https://www.kaggle.com/jroberayalas" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/88198-kg.jpg" alt="jroberayalas" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="PJ Trainor" data-tooltip-size="small"><a href="https://www.kaggle.com/trainorpj" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/98021-kg.jpg" alt="PJ Trainor" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Oleg Melnikov" data-tooltip-size="small"><a href="https://www.kaggle.com/olegmelnikov" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/124234-kg.jpg" alt="Oleg Melnikov" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Rafael Barbolo" data-tooltip-size="small"><a href="https://www.kaggle.com/barbolo" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/129554-gr.jpg" alt="Rafael Barbolo" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Bcottman" data-tooltip-size="small"><a href="https://www.kaggle.com/bcottman" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/188941-kg.jpg" alt="Bcottman" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="CXQ" data-tooltip-size="small"><a href="https://www.kaggle.com/caoxiaoqing" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/201481-fb.jpg" alt="CXQ" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Sriram Ramanathan" data-tooltip-size="small"><a href="https://www.kaggle.com/sriramanathan" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/225310-kg.jpg" alt="Sriram Ramanathan" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-more"><span class="tooltip-container" data-tooltip="Donlo Wong" data-tooltip-size="small"><a href="https://www.kaggle.com/cfwongaf" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/default-thumb.png" alt="Donlo Wong" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Mr.Devlar" data-tooltip-size="small"><a href="https://www.kaggle.com/mrdevlar" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/270510-kg.png" alt="Mr.Devlar" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="ifashion" data-tooltip-size="small"><a href="https://www.kaggle.com/ifashion" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/384029-kg.jpeg" alt="ifashion" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Larry" data-tooltip-size="small"><a href="https://www.kaggle.com/larry0220" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/455304-fb.jpg" alt="Larry" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Avinash" data-tooltip-size="small"><a href="https://www.kaggle.com/avinashtum" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/458419-kg.jpg" alt="Avinash" class="upvote-suggestion__voter-img"></a></span></div><div class="upvote-suggestion__voter upvote-suggestion__voter-other"><span class="tooltip-container" data-tooltip="Mili Hadziomerovic" data-tooltip-size="small"><a href="https://www.kaggle.com/milihadziomerovic" class="upvote-suggestion__voter-link"><img src="./Embedding Layers _ Kaggle_files/459665-gp.jpg" alt="Mili Hadziomerovic" class="upvote-suggestion__voter-img"></a></span></div></div></div></div></div></div></div><div class="KernelViewer_EmptyColumn-sc-bggm6s hnmdWt"></div></div></div></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push({"kernel":{"id":1592233,"title":"Embedding Layers","forkParent":null,"currentRunId":7193256,"mostRecentRunId":7193256,"url":"/colinmorris/embedding-layers","tags":[],"commentCount":0,"upvoteCount":122,"viewCount":23388,"forkCount":293,"bestPublicScore":null,"author":{"id":473824,"displayName":"ColinMorris","email":null,"editedEmail":null,"editedEmailCode":null,"userName":"colinmorris","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","profileUrl":"/colinmorris","registerDate":"0001-01-01T00:00:00Z","lastVisitDate":"0001-01-01T00:00:00Z","statusId":0,"performanceTier":3,"userRoles":null,"userLogins":null,"groupIds":null,"duplicateUsers":null,"hasPhoneVerifications":false,"failedNerdchas":0,"hasPendingNerdcha":false,"deleteRequests":null,"userAttributes":null,"isAdmin":false,"isTvc":false,"isKaggleBot":false,"isAdminOrTvc":false,"isAnonymous":false,"canAct":false,"canBeSeen":false,"thumbnailName":null,"activationCode":"00000000-0000-0000-0000-000000000000","isPhoneVerified":false},"isPrivate":false,"updatedTime":"2018-11-08T17:35:25.4866667Z","selfLink":"/kernels/1592233","pinnedDockerImageVersionId":null,"isLanguageTemplate":false,"medal":"gold","topicId":68614,"readGroupId":19607,"writeGroupId":22340,"slug":"embedding-layers"},"kernelBlob":{"id":99858742,"settings":{"dockerImageVersionId":null,"dataSources":[{"sourceType":"KernelVersion","sourceId":6375455,"databundleVersionId":null,"mountSlug":null}],"sourceType":"notebook","language":"python","isGpuEnabled":false,"isInternetEnabled":false},"source":"{\u0022cells\u0022:[{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022af4b271b614d07e4444dc4188f384dd0bf358406\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Welcome to our first lesson on the topic of **embeddings**. In this lesson, I\u0027ll show how to implement a model with embedding layers using the `tf.keras` API. Embeddings are a technique that enable deep neural nets to work with **sparse categorical variables**.\\n\\n# Sparse Categorical Variables\\n\\nBy this I mean a categorical variable with lots of possible values (high *cardinality*), with a small number of them (often just 1) present in any given observation. One good example is words. There are hundreds of thousands of them in the English language, but a single tweet might only have a dozen. Word embeddings are a crucial technique for applying deep learning to natural language. But other examples abound.\\n\\nFor example, [this dataset of LA county restaurant inspections](https://www.kaggle.com/meganrisdal/la-county-restaurant-inspections-and-violations) has several sparse categorical variables, including:\\n- `employee_id`: which of the health department\u0027s employees performed this inspection? (~250 distinct values)\\n- `facility_zip`: what zip code is the restaurant located in? (~3,000 distinct values)\\n- `owner_name`: who owns the restaurant? (~35,000 distinct values)\\n\\nAn embedding layer would be a good idea for using any of these variables as inputs to a network.\\n\\nIn this lesson, I\u0027ll be using the [MovieLens dataset](https://www.kaggle.com/grouplens/movielens-20m-dataset) as an example.\\n\\n# MovieLens\\n\\nThe MovieLens dataset consists of ratings assigned to movies by users. Here\u0027s a sample:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00220256299053774ce4384d6c5b422ee9d196bb3f21\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\n# Setup. Import libraries and load dataframes for Movielens data.\\nimport numpy as np\\nimport pandas as pd\\nfrom matplotlib import pyplot as plt\\nimport tensorflow as tf\\nfrom tensorflow import keras\\nimport os\\nimport random\\n\\ntf.set_random_seed(1); np.random.seed(1); random.seed(1) # Set random seeds for reproducibility\\n\\ninput_dir = \u0027../input\u0027\\nratings_path = os.path.join(input_dir, \u0027rating.csv\u0027)\\n\\nratings_df = pd.read_csv(ratings_path, usecols=[\u0027userId\u0027, \u0027movieId\u0027, \u0027rating\u0027, \u0027y\u0027])\\n\\nmovies_df = pd.read_csv(os.path.join(input_dir, \u0027movie.csv\u0027), usecols=[\u0027movieId\u0027, \u0027title\u0027, \u0027year\u0027])\\n\\ndf = ratings_df.merge(movies_df, on=\u0027movieId\u0027).sort_values(by=\u0027userId\u0027)\\ndf = df.sample(frac=1, random_state=1) # Shuffle\\n\\ndf.sample(5, random_state=1)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00225239d74ad582b777918aac9dc8d81907fcba44da\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Ratings range from 0.5 stars to 5. Our goal will be to predict the rating a given user $u_i$ will give a particular movie $m_j$. (The column `y` is just a copy of the rating column with the mean subtracted - this will be useful later.)\\n\\n`userId` and `movieId` are both sparse categorical variables. They have many possible values:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00226a1605bc1d7af9b9b40f405bf08711e3c033c334\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nn_movies = len(df.movieId.unique())\\nn_users = len(df.userId.unique())\\nprint(\\n    \\\u0022{1:,} distinct users rated {0:,} different movies (total ratings = {2:,})\\\u0022.format(\\n        n_movies, n_users, len(df),\\n    )\\n)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022ccc058ea5cda9e6264c73cef4bf07e872d229957\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022# Building a rating prediction model in Keras\\n\\nWe want to build a model that takes a user, $u_i$ and a movie, $m_j$, and outputs a number from 0.5-5, representing how many stars we think this user would give that movie. \\n\\n\u003e **Aside:** You may have noticed that the [MovieLens dataset](https://www.kaggle.com/grouplens/movielens-20m-dataset) includes information about each movie such as its title, its year of release, a set of genres and user-assigned tags. But for now, we\u0027re not going to try to exploit any of that extra information.\\n\\nI claim we need an embedding layer to handle these inputs. Why? Let\u0027s review some alternatives and see why they don\u0027t work.\\n\\n## Bad idea #1: Use user ids and movie ids as numerical inputs\\n\\nWhy not feed in user ids and movie ids as inputs, then add on some dense layers and call it a day? i.e.:\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022051cb8c39117da3f9b5a50e45181d066a0b9904b\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022model = keras.Sequential([\\n    # 2 input values: user id and movie id\\n    keras.layers.Dense(256, input_dim=2, activation=\u0027relu\u0027),\\n    keras.layers.Dense(32, activation=\u0027relu\u0027),\\n    # A single output node, containing the predicted rating\\n    keras.layers.Dense(1)\\n])\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022dd4d97ae9c78c818f6570f69ce598ea4206349c0\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022In the simplest terms, neural nets work by doing math on their inputs. But the actual numerical values of the ids assigned to users and movies are meaningless. *Schindler\u0027s List* has id 527 and *The Usual Suspects* has id 50, but that doesn\u0027t mean *Schindler\u0027s List* is \u0027ten times bigger\u0027 than *The Usual Suspects*.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022267ebc871b52db908f57dea980e11a0a144ee014\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Bad idea #2: One-hot encoded user and movie inputs\\n\\nIf you\u0027re not familiar with one-hot encoding, you may want to check out our lesson [Using Categorical Data with One Hot Encoding](https://www.kaggle.com/dansbecker/using-categorical-data-with-one-hot-encoding).\\n\\nIn that lesson, we claim that one-hot encoding is \\\u0022The Standard Approach for Categorical Data\\\u0022. So why is it a bad idea here? Let\u0027s see what a model would look like that took one-hot encoded users and movies.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022f40fde6725d83c995b17eeb2c84262c14b22a421\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022input_size = n_movies + n_users\\nprint(\\\u0022Input size = {:,} ({:,} movies + {:,} users)\\\u0022.format(\\n    input_size, n_movies, n_users,\\n))\\nmodel = keras.Sequential([\\n    # One hidden layer with 128 units\\n    keras.layers.Dense(128, input_dim=input_size, activation=\u0027relu\u0027),\\n    # A single output node, containing the predicted rating\\n    keras.layers.Dense(1)\\n])\\nmodel.summary()\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002202e7c6667f9ead3894a015a06f5e59ee547060ad\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022A basic issue here is scaling and efficiency. A single input to our model is a vector of 165,237 numbers (of which we know that 165,235 will be zeros). The feature data for our whole dataset of 20 million rating instances will require a 2-d array of size 20,000,000 x 165,237, or about 3 **trillion** numbers. Good luck fitting that all into memory at once!\\n\\nAlso, doing training and inference on our model will be inefficient. To calculate the activations of our first hidden layer, we\u0027ll need to multiply our 165k inputs through about 21 million weights - but the vast, vast majority of those products will just be zero.\\n\\nOne-hot encoding is fine for categorical variables with a small number of possible values, like `{Red, Yellow, Green}`, or `{Monday, Tuesday, Wednesday, Friday, Saturday, Sunday}`. But it\u0027s not so great in cases like our movie recommendation problem, where variables have tens or hundreds of thousands of possible values.\\n\\n## Good idea: Embedding layers\\n\\nIn short, an **embedding layer** maps each element in a set of discrete things (like words, users, or movies) to a dense vector of real numbers (its **embedding**). \\n\\n\u003e **Aside:** A key implementation detail is that embedding layers take as input the *index* of the entity being embedded (i.e. we can give it our userIds and movieIds as input). You can think of it as a sort of \u0027lookup table\u0027. This is much more efficient than taking a one-hot vector and doing a huge matrix multiplication!\\n\\nAs an example, if we learn embeddings of size 8 for movies, the embedding for *Legally Blonde* (index=4352) might look like:\\n\\n$$[ 1.624, -0.612, -0.528, -1.073,  0.865, -2.302,  1.745, -0.761]$$\\n\\n**Where do these come from?** We initialize an embedding for each user and movie using random noise, then we train them as part of the process of training the overall rating-prediction model. \\n\\n**What do they mean?** An object\u0027s embedding, if it\u0027s any good, should capture some useful latent properties of that object. But the key word here is *latent* AKA hidden. It\u0027s up to the model to discover whatever properties of the entities are useful for the prediction task, and encode them in the embedding space. Sound mysterious? In later lessons I\u0027ll show some techniques for interpreting learned embeddings, such as visualizing them with the t-SNE algorithm.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022fa70585e512ee6e095d5309034d344c74fb7d533\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Implementing it\\n\\nI want my model to look something like this:\\n\\n![Imgur](https://i.imgur.com/Z1eVQu9.png)\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00220cc9049b23066e18046fca655b39ad601158af85\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022A key thing to note is that this network is not simply a stack of layers from input to output. We\u0027re treating the user and the movie as separate inputs, which come together only after each has gone through its own embedding layer.\\n\\nThis means that the [keras.Sequential](https://www.tensorflow.org/api_docs/python/tf/keras/Sequential) class (which you may be familiar with from our [course on deep learning with image data](https://www.kaggle.com/learn/deep-learning)) won\u0027t work. We\u0027ll need to turn to the more powerful \u0027functional API\u0027, using the [keras.Model](https://www.tensorflow.org/api_docs/python/tf/keras/Model) class. For more detail on the Functional API, check out [Keras\u0027s guide, here](https://keras.io/getting-started/functional-api-guide/).\\n\\nHere\u0027s the code:\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00223a1cc608e9f334d2a356cc5b00216baa50a52fcb\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022hidden_units = (32,4)\\nmovie_embedding_size = 8\\nuser_embedding_size = 8\\n\\n# Each instance will consist of two inputs: a single user id, and a single movie id\\nuser_id_input = keras.Input(shape=(1,), name=\u0027user_id\u0027)\\nmovie_id_input = keras.Input(shape=(1,), name=\u0027movie_id\u0027)\\nuser_embedded = keras.layers.Embedding(df.userId.max()+1, user_embedding_size, \\n                                       input_length=1, name=\u0027user_embedding\u0027)(user_id_input)\\nmovie_embedded = keras.layers.Embedding(df.movieId.max()+1, movie_embedding_size, \\n                                        input_length=1, name=\u0027movie_embedding\u0027)(movie_id_input)\\n# Concatenate the embeddings (and remove the useless extra dimension)\\nconcatenated = keras.layers.Concatenate()([user_embedded, movie_embedded])\\nout = keras.layers.Flatten()(concatenated)\\n\\n# Add one or more hidden layers\\nfor n_hidden in hidden_units:\\n    out = keras.layers.Dense(n_hidden, activation=\u0027relu\u0027)(out)\\n\\n# A single output: our predicted rating\\nout = keras.layers.Dense(1, activation=\u0027linear\u0027, name=\u0027prediction\u0027)(out)\\n\\nmodel = keras.Model(\\n    inputs = [user_id_input, movie_id_input],\\n    outputs = out,\\n)\\nmodel.summary(line_length=88)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002270da17016222cdbbb9d7705522cbfd33bb316c70\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Training it\\n\\nWe\u0027ll compile our model to minimize squared error (\u0027MSE\u0027). We\u0027ll also include absolute error (\u0027MAE\u0027) as a metric to report during training, since it\u0027s a bit easier to interpret.\\n\\n\u003e Something to think about: We know that ratings can only take on the values `{0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5}` - so why not treat this as a multiclass classification problem with 10 classes, one for each possible star rating?\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u002239751565e9338ec5197e3fd0afce6fcef7dac1ea\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022model.compile(\\n    # Technical note: when using embedding layers, I highly recommend using one of the optimizers\\n    # found  in tf.train: https://www.tensorflow.org/api_guides/python/train#Optimizers\\n    # Passing in a string like \u0027adam\u0027 or \u0027SGD\u0027 will load one of keras\u0027s optimizers (found under \\n    # tf.keras.optimizers). They seem to be much slower on problems like this, because they\\n    # don\u0027t efficiently handle sparse gradient updates.\\n    tf.train.AdamOptimizer(0.005),\\n    loss=\u0027MSE\u0027,\\n    metrics=[\u0027MAE\u0027],\\n)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002256cdd49ec046ddf40d828c594cc8b88f3a643398\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Let\u0027s train the model.\\n\\n\u003e **Aside**: I\u0027m passing in `df.y` as my target variable rather than `df.rating`. The `y` column is just a \u0027centered\u0027 version of the rating - i.e. the rating column minus its mean over the training set. For example, if the overall average rating in the training set was 3 stars, then we would translate 3 star ratings to 0, 5 star ratings to 2.0, etc. to get `y`. This is a common practice in deep learning, and tends to help achieve better results in fewer epochs. For more details, feel free to check out [this kernel](https://www.kaggle.com/colinmorris/movielens-preprocessing) with all the preprocessing I performed on the MovieLens dataset.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022f4949348044a9307736945766e24b732bf8ffdb6\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022history = model.fit(\\n    [df.userId, df.movieId],\\n    df.y,\\n    batch_size=5000,\\n    epochs=20,\\n    verbose=0,\\n    validation_split=.05,\\n);\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00227b5fbd39513e8aa02318ab09f891222a65438435\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022To judge whether our model is any good, it\u0027d be helpful to have a baseline. In the cell below, we calculate the error of a couple dumb baselines: always predicting the global average rating, and predicting the average rating per movie:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u002224e1226b8ded8b9e95b880ab36083f31bd5cb2e4\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nfrom sklearn.model_selection import train_test_split\\nfrom sklearn import metrics\\n\\ndf_train, df_val = train_test_split(df, test_size=.05, random_state=1)\\n\\ndef get_metrics(y_true, y_pred):\\n    return metrics.mean_absolute_error(y_true, y_pred), metrics.mean_squared_error(y_true, y_pred)\\n\\nmean_rating = df_train[\u0027rating\u0027].mean()\\nprint(\\\u0022Average rating in training set is {:.2f} stars\\\u0022.format(mean_rating))\\n\\ny_true = df_val[\u0027rating\u0027].values\\nalways_mean = np.full(y_true.shape, mean_rating)\\n\\nmae, mse = get_metrics(y_true, always_mean)\\nprint(\\\u0022Always predicting global average rating results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}\\\u0022.format(\\n    mae, mse))\\n\\nmovies = movies_df.copy().set_index(\u0027movieId\u0027)\\nmean_per_movie = df_train.groupby(\u0027movieId\u0027)[\u0027rating\u0027].mean()\\nmovies[\u0027mean_rating\u0027] = mean_per_movie\\nratings_per_movie = df_train.groupby(\u0027movieId\u0027).size()\\nmovies[\u0027n_ratings\u0027] = ratings_per_movie\\n# There are a few movies in the validation set not present in the training set. We\u0027ll just use the global\\n# mean rating in their case.\\ny_movie_mean = df_val.join(mean_per_movie, on=\u0027movieId\u0027, rsuffix=\u0027mean\u0027)[\u0027ratingmean\u0027].fillna(mean_rating).values\\n\\nmae, mse = get_metrics(y_true, y_movie_mean)\\nprint(\\\u0022Predicting mean per movie results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}\\\u0022.format(mae, mse))\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00226537eaa40ec56101f79527cc58f516bdf3504382\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Here\u0027s a plot of our embedding model\u0027s absolute error over time. For comparison, our best baseline (predicting the average rating per movie) is marked with a dotted line:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022250a4ecbf2b274ed6ba99c781a4bba962eb7167c\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nfig, ax = plt.subplots(figsize=(15, 6))\\nax.plot(history.epoch, history.history[\u0027val_mean_absolute_error\u0027], label=\u0027Validation MAE\u0027)\\nax.plot(history.epoch, history.history[\u0027mean_absolute_error\u0027], label=\u0027Training MAE\u0027)\\nax.set_xlabel(\u0027Epoch\u0027)\\nax.set_ylabel(\u0027Mean Absolute Error\u0027)\\nax.set_xlim(left=0, right=history.epoch[-1])\\nbaseline_mae = 0.73\\nax.axhline(baseline_mae, ls=\u0027--\u0027, label=\u0027Baseline\u0027, color=\u0027#002255\u0027, alpha=.5)\\nax.grid()\\nfig.legend();\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00223f5ab52d611e1514371582974a2065f937208c2c\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\n# Save training history for later comparison\\nhdf = pd.DataFrame(dict(\\n    epoch=history.epoch,\\n    val_mae=history.history[\u0027val_mean_absolute_error\u0027],\\n    train_mae=history.history[\u0027mean_absolute_error\u0027],\\n))\\nhdf.to_csv(\u0027history-1.csv\u0027)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00228f5eef91cbeaf72c3e39e8dd66d00cd2b68449b7\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Compared to the baseline, we were able to get our average error down by more than .1 stars (or about 15%). Not bad!\\n\\n## Example predictions\\n\\nLet\u0027s try some example predictions as a sanity check. We\u0027ll start by picking out a specific user from the dataset at random.\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00229a4e4a1c144b8fbfd2aac2516ae6238f6cc2952f\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nratings_per_user = df.groupby(\u0027userId\u0027).size()\\nuid = ratings_per_user[ratings_per_user \u003c 30].sample(1, random_state=1).index[0]\\nuser_ratings = df[df.userId==uid]\\nprint(\\\u0022User #{} has rated {} movies (avg. rating = {:.1f}):\\\u0022.format(\\n    uid, len(user_ratings), user_ratings[\u0027rating\u0027].mean(),\\n))\\ncols = [\u0027userId\u0027, \u0027movieId\u0027, \u0027rating\u0027, \u0027title\u0027, \u0027year\u0027]\\nuser_ratings.sort_values(by=\u0027rating\u0027, ascending=False)[cols]\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00221410d00338aba351613406fe30043c9711007967\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022User 26556 has given out two perfect ratings to the movies *Airplane!* and *Airplane II: The Sequel*. Great choices! Perhaps they\u0027d also enjoy the [*The Naked Gun*](https://en.wikipedia.org/wiki/The_Naked_Gun) series - another series of spoof films starring Leslie Nielsen.\\n\\nWe don\u0027t have as much evidence about what this user hates. Rather than extrapolating from their few low ratings, a better indication of this user\u0027s dislikes might be the kinds of movies they haven\u0027t even rated. Let\u0027s also throw in a couple examples of movies that this user seems unlikely to ever watch, according to their rating history.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022b28e7bf92d12f4633901035f71f0451b95d0200d\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022candidate_movies = movies[\\n    movies.title.str.contains(\u0027Naked Gun\u0027)\\n    | (movies.title == \u0027The Sisterhood of the Traveling Pants\u0027)\\n    | (movies.title == \u0027Lilo \u0026 Stitch\u0027)\\n].copy()\\n\\npreds = model.predict([\\n    [uid] * len(candidate_movies), # User ids \\n    candidate_movies.index, # Movie ids\\n])\\n# NB: Remember we trained on \u0027y\u0027, which was a version of the rating column centered on 0. To translate\\n# our model\u0027s output values to the original [0.5, 5] star rating scale, we need to \u0027uncenter\u0027 the\\n# values, by adding the mean back\\nrow = df.iloc[0] # The difference between rating and y will be the same for all rows, so we can just use the first\\ny_delta = row.rating - row.y\\ncandidate_movies[\u0027predicted_rating\u0027] = preds + y_delta\\n# Add a column with the difference between our predicted rating (for this user) and the movie\u0027s\\n# overall average rating across all users in the dataset.\\ncandidate_movies[\u0027delta\u0027] = candidate_movies[\u0027predicted_rating\u0027] - candidate_movies[\u0027mean_rating\u0027]\\ncandidate_movies.sort_values(by=\u0027delta\u0027, ascending=False)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022af4348a1bf31d5ec17c230c117768acac3a136fc\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Looks pretty reasonable! For each of the movies in the *The Naked Gun* series, our predicted ratings for this user are around a full star above the average rating in the dataset, and our \u0027out of left field\u0027 picks have their predicted ratings downgraded compared to average.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022b590532284424329076efff896d99d90ff3a3a15\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022# Your turn!\\n\\nHead over to [the Exercises notebook](https://www.kaggle.com/kernels/fork/1598432) to get some hands-on practice working with embedding layers.\\n### P.S...\\n\\nThis course is still in beta, so I\u0027d love to get your feedback. If you have a moment to [fill out a super-short survey about this lesson](https://form.jotform.com/82826168584267), I\u0027d greatly appreciate it. You can also leave public feedback in the comments below, or on the [Learn Forum](https://www.kaggle.com/learn-forum).\\n\u0022}],\u0022metadata\u0022:{\u0022kernelspec\u0022:{\u0022display_name\u0022:\u0022Python 3\u0022,\u0022language\u0022:\u0022python\u0022,\u0022name\u0022:\u0022python3\u0022},\u0022language_info\u0022:{\u0022codemirror_mode\u0022:{\u0022name\u0022:\u0022ipython\u0022,\u0022version\u0022:3},\u0022file_extension\u0022:\u0022.py\u0022,\u0022mimetype\u0022:\u0022text/x-python\u0022,\u0022name\u0022:\u0022python\u0022,\u0022nbconvert_exporter\u0022:\u0022python\u0022,\u0022pygments_lexer\u0022:\u0022ipython3\u0022,\u0022version\u0022:\u00223.6.5\u0022},\u0022learntools_metadata\u0022:{\u0022lesson_index\u0022:0,\u0022type\u0022:\u0022tutorial\u0022}},\u0022nbformat\u0022:4,\u0022nbformat_minor\u0022:1}","dateCreated":"2018-11-08T17:35:25.3250308Z"},"kernelRun":{"id":7193256,"kernelId":1592233,"status":"complete","type":"batch","sourceType":"notebook","language":"python","title":"Embedding Layers","dateCreated":"2018-11-08T17:35:25.403Z","dateEvaluated":"2018-11-08T17:35:25.487Z","workerContainerPort":null,"workerUptimeSeconds":14023,"workerIPAddress":"172.16.16.133  ","scriptLanguageId":9,"scriptLanguageName":"IPython Notebook HTML","renderedOutputUrl":"https://www.kaggleusercontent.com/kf/7193256/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..GbCKBF1Guch_6zUCnAMgYw.ZYE9kvDFKcDodKTaOS1si3F-JxvdE0fXRI8vlxqTfJG0W7-TxAh-PkCoyEBd55_1F63V_RWJSrSYkkf8N87oE2kQksTLofnM7vEIblCq2bY0ulST4npeDKPTg1zJIP0uB20Q6TcP8IylImvfyvmepA._Zr0hFqMvIv0m5qX8W2syw/__results__.html","commit":{"id":99858742,"settings":{"dockerImageVersionId":null,"dataSources":[{"sourceType":"KernelVersion","sourceId":6375455,"databundleVersionId":null,"mountSlug":null}],"sourceType":"notebook","language":"python","isGpuEnabled":false,"isInternetEnabled":false},"source":"{\u0022cells\u0022:[{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022af4b271b614d07e4444dc4188f384dd0bf358406\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Welcome to our first lesson on the topic of **embeddings**. In this lesson, I\u0027ll show how to implement a model with embedding layers using the `tf.keras` API. Embeddings are a technique that enable deep neural nets to work with **sparse categorical variables**.\\n\\n# Sparse Categorical Variables\\n\\nBy this I mean a categorical variable with lots of possible values (high *cardinality*), with a small number of them (often just 1) present in any given observation. One good example is words. There are hundreds of thousands of them in the English language, but a single tweet might only have a dozen. Word embeddings are a crucial technique for applying deep learning to natural language. But other examples abound.\\n\\nFor example, [this dataset of LA county restaurant inspections](https://www.kaggle.com/meganrisdal/la-county-restaurant-inspections-and-violations) has several sparse categorical variables, including:\\n- `employee_id`: which of the health department\u0027s employees performed this inspection? (~250 distinct values)\\n- `facility_zip`: what zip code is the restaurant located in? (~3,000 distinct values)\\n- `owner_name`: who owns the restaurant? (~35,000 distinct values)\\n\\nAn embedding layer would be a good idea for using any of these variables as inputs to a network.\\n\\nIn this lesson, I\u0027ll be using the [MovieLens dataset](https://www.kaggle.com/grouplens/movielens-20m-dataset) as an example.\\n\\n# MovieLens\\n\\nThe MovieLens dataset consists of ratings assigned to movies by users. Here\u0027s a sample:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00220256299053774ce4384d6c5b422ee9d196bb3f21\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\n# Setup. Import libraries and load dataframes for Movielens data.\\nimport numpy as np\\nimport pandas as pd\\nfrom matplotlib import pyplot as plt\\nimport tensorflow as tf\\nfrom tensorflow import keras\\nimport os\\nimport random\\n\\ntf.set_random_seed(1); np.random.seed(1); random.seed(1) # Set random seeds for reproducibility\\n\\ninput_dir = \u0027../input\u0027\\nratings_path = os.path.join(input_dir, \u0027rating.csv\u0027)\\n\\nratings_df = pd.read_csv(ratings_path, usecols=[\u0027userId\u0027, \u0027movieId\u0027, \u0027rating\u0027, \u0027y\u0027])\\n\\nmovies_df = pd.read_csv(os.path.join(input_dir, \u0027movie.csv\u0027), usecols=[\u0027movieId\u0027, \u0027title\u0027, \u0027year\u0027])\\n\\ndf = ratings_df.merge(movies_df, on=\u0027movieId\u0027).sort_values(by=\u0027userId\u0027)\\ndf = df.sample(frac=1, random_state=1) # Shuffle\\n\\ndf.sample(5, random_state=1)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00225239d74ad582b777918aac9dc8d81907fcba44da\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Ratings range from 0.5 stars to 5. Our goal will be to predict the rating a given user $u_i$ will give a particular movie $m_j$. (The column `y` is just a copy of the rating column with the mean subtracted - this will be useful later.)\\n\\n`userId` and `movieId` are both sparse categorical variables. They have many possible values:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00226a1605bc1d7af9b9b40f405bf08711e3c033c334\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nn_movies = len(df.movieId.unique())\\nn_users = len(df.userId.unique())\\nprint(\\n    \\\u0022{1:,} distinct users rated {0:,} different movies (total ratings = {2:,})\\\u0022.format(\\n        n_movies, n_users, len(df),\\n    )\\n)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022ccc058ea5cda9e6264c73cef4bf07e872d229957\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022# Building a rating prediction model in Keras\\n\\nWe want to build a model that takes a user, $u_i$ and a movie, $m_j$, and outputs a number from 0.5-5, representing how many stars we think this user would give that movie. \\n\\n\u003e **Aside:** You may have noticed that the [MovieLens dataset](https://www.kaggle.com/grouplens/movielens-20m-dataset) includes information about each movie such as its title, its year of release, a set of genres and user-assigned tags. But for now, we\u0027re not going to try to exploit any of that extra information.\\n\\nI claim we need an embedding layer to handle these inputs. Why? Let\u0027s review some alternatives and see why they don\u0027t work.\\n\\n## Bad idea #1: Use user ids and movie ids as numerical inputs\\n\\nWhy not feed in user ids and movie ids as inputs, then add on some dense layers and call it a day? i.e.:\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022051cb8c39117da3f9b5a50e45181d066a0b9904b\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022model = keras.Sequential([\\n    # 2 input values: user id and movie id\\n    keras.layers.Dense(256, input_dim=2, activation=\u0027relu\u0027),\\n    keras.layers.Dense(32, activation=\u0027relu\u0027),\\n    # A single output node, containing the predicted rating\\n    keras.layers.Dense(1)\\n])\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022dd4d97ae9c78c818f6570f69ce598ea4206349c0\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022In the simplest terms, neural nets work by doing math on their inputs. But the actual numerical values of the ids assigned to users and movies are meaningless. *Schindler\u0027s List* has id 527 and *The Usual Suspects* has id 50, but that doesn\u0027t mean *Schindler\u0027s List* is \u0027ten times bigger\u0027 than *The Usual Suspects*.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022267ebc871b52db908f57dea980e11a0a144ee014\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Bad idea #2: One-hot encoded user and movie inputs\\n\\nIf you\u0027re not familiar with one-hot encoding, you may want to check out our lesson [Using Categorical Data with One Hot Encoding](https://www.kaggle.com/dansbecker/using-categorical-data-with-one-hot-encoding).\\n\\nIn that lesson, we claim that one-hot encoding is \\\u0022The Standard Approach for Categorical Data\\\u0022. So why is it a bad idea here? Let\u0027s see what a model would look like that took one-hot encoded users and movies.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022f40fde6725d83c995b17eeb2c84262c14b22a421\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022input_size = n_movies + n_users\\nprint(\\\u0022Input size = {:,} ({:,} movies + {:,} users)\\\u0022.format(\\n    input_size, n_movies, n_users,\\n))\\nmodel = keras.Sequential([\\n    # One hidden layer with 128 units\\n    keras.layers.Dense(128, input_dim=input_size, activation=\u0027relu\u0027),\\n    # A single output node, containing the predicted rating\\n    keras.layers.Dense(1)\\n])\\nmodel.summary()\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002202e7c6667f9ead3894a015a06f5e59ee547060ad\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022A basic issue here is scaling and efficiency. A single input to our model is a vector of 165,237 numbers (of which we know that 165,235 will be zeros). The feature data for our whole dataset of 20 million rating instances will require a 2-d array of size 20,000,000 x 165,237, or about 3 **trillion** numbers. Good luck fitting that all into memory at once!\\n\\nAlso, doing training and inference on our model will be inefficient. To calculate the activations of our first hidden layer, we\u0027ll need to multiply our 165k inputs through about 21 million weights - but the vast, vast majority of those products will just be zero.\\n\\nOne-hot encoding is fine for categorical variables with a small number of possible values, like `{Red, Yellow, Green}`, or `{Monday, Tuesday, Wednesday, Friday, Saturday, Sunday}`. But it\u0027s not so great in cases like our movie recommendation problem, where variables have tens or hundreds of thousands of possible values.\\n\\n## Good idea: Embedding layers\\n\\nIn short, an **embedding layer** maps each element in a set of discrete things (like words, users, or movies) to a dense vector of real numbers (its **embedding**). \\n\\n\u003e **Aside:** A key implementation detail is that embedding layers take as input the *index* of the entity being embedded (i.e. we can give it our userIds and movieIds as input). You can think of it as a sort of \u0027lookup table\u0027. This is much more efficient than taking a one-hot vector and doing a huge matrix multiplication!\\n\\nAs an example, if we learn embeddings of size 8 for movies, the embedding for *Legally Blonde* (index=4352) might look like:\\n\\n$$[ 1.624, -0.612, -0.528, -1.073,  0.865, -2.302,  1.745, -0.761]$$\\n\\n**Where do these come from?** We initialize an embedding for each user and movie using random noise, then we train them as part of the process of training the overall rating-prediction model. \\n\\n**What do they mean?** An object\u0027s embedding, if it\u0027s any good, should capture some useful latent properties of that object. But the key word here is *latent* AKA hidden. It\u0027s up to the model to discover whatever properties of the entities are useful for the prediction task, and encode them in the embedding space. Sound mysterious? In later lessons I\u0027ll show some techniques for interpreting learned embeddings, such as visualizing them with the t-SNE algorithm.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022fa70585e512ee6e095d5309034d344c74fb7d533\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Implementing it\\n\\nI want my model to look something like this:\\n\\n![Imgur](https://i.imgur.com/Z1eVQu9.png)\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00220cc9049b23066e18046fca655b39ad601158af85\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022A key thing to note is that this network is not simply a stack of layers from input to output. We\u0027re treating the user and the movie as separate inputs, which come together only after each has gone through its own embedding layer.\\n\\nThis means that the [keras.Sequential](https://www.tensorflow.org/api_docs/python/tf/keras/Sequential) class (which you may be familiar with from our [course on deep learning with image data](https://www.kaggle.com/learn/deep-learning)) won\u0027t work. We\u0027ll need to turn to the more powerful \u0027functional API\u0027, using the [keras.Model](https://www.tensorflow.org/api_docs/python/tf/keras/Model) class. For more detail on the Functional API, check out [Keras\u0027s guide, here](https://keras.io/getting-started/functional-api-guide/).\\n\\nHere\u0027s the code:\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00223a1cc608e9f334d2a356cc5b00216baa50a52fcb\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022hidden_units = (32,4)\\nmovie_embedding_size = 8\\nuser_embedding_size = 8\\n\\n# Each instance will consist of two inputs: a single user id, and a single movie id\\nuser_id_input = keras.Input(shape=(1,), name=\u0027user_id\u0027)\\nmovie_id_input = keras.Input(shape=(1,), name=\u0027movie_id\u0027)\\nuser_embedded = keras.layers.Embedding(df.userId.max()+1, user_embedding_size, \\n                                       input_length=1, name=\u0027user_embedding\u0027)(user_id_input)\\nmovie_embedded = keras.layers.Embedding(df.movieId.max()+1, movie_embedding_size, \\n                                        input_length=1, name=\u0027movie_embedding\u0027)(movie_id_input)\\n# Concatenate the embeddings (and remove the useless extra dimension)\\nconcatenated = keras.layers.Concatenate()([user_embedded, movie_embedded])\\nout = keras.layers.Flatten()(concatenated)\\n\\n# Add one or more hidden layers\\nfor n_hidden in hidden_units:\\n    out = keras.layers.Dense(n_hidden, activation=\u0027relu\u0027)(out)\\n\\n# A single output: our predicted rating\\nout = keras.layers.Dense(1, activation=\u0027linear\u0027, name=\u0027prediction\u0027)(out)\\n\\nmodel = keras.Model(\\n    inputs = [user_id_input, movie_id_input],\\n    outputs = out,\\n)\\nmodel.summary(line_length=88)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002270da17016222cdbbb9d7705522cbfd33bb316c70\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022## Training it\\n\\nWe\u0027ll compile our model to minimize squared error (\u0027MSE\u0027). We\u0027ll also include absolute error (\u0027MAE\u0027) as a metric to report during training, since it\u0027s a bit easier to interpret.\\n\\n\u003e Something to think about: We know that ratings can only take on the values `{0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5}` - so why not treat this as a multiclass classification problem with 10 classes, one for each possible star rating?\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u002239751565e9338ec5197e3fd0afce6fcef7dac1ea\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022model.compile(\\n    # Technical note: when using embedding layers, I highly recommend using one of the optimizers\\n    # found  in tf.train: https://www.tensorflow.org/api_guides/python/train#Optimizers\\n    # Passing in a string like \u0027adam\u0027 or \u0027SGD\u0027 will load one of keras\u0027s optimizers (found under \\n    # tf.keras.optimizers). They seem to be much slower on problems like this, because they\\n    # don\u0027t efficiently handle sparse gradient updates.\\n    tf.train.AdamOptimizer(0.005),\\n    loss=\u0027MSE\u0027,\\n    metrics=[\u0027MAE\u0027],\\n)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u002256cdd49ec046ddf40d828c594cc8b88f3a643398\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Let\u0027s train the model.\\n\\n\u003e **Aside**: I\u0027m passing in `df.y` as my target variable rather than `df.rating`. The `y` column is just a \u0027centered\u0027 version of the rating - i.e. the rating column minus its mean over the training set. For example, if the overall average rating in the training set was 3 stars, then we would translate 3 star ratings to 0, 5 star ratings to 2.0, etc. to get `y`. This is a common practice in deep learning, and tends to help achieve better results in fewer epochs. For more details, feel free to check out [this kernel](https://www.kaggle.com/colinmorris/movielens-preprocessing) with all the preprocessing I performed on the MovieLens dataset.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022f4949348044a9307736945766e24b732bf8ffdb6\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022history = model.fit(\\n    [df.userId, df.movieId],\\n    df.y,\\n    batch_size=5000,\\n    epochs=20,\\n    verbose=0,\\n    validation_split=.05,\\n);\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00227b5fbd39513e8aa02318ab09f891222a65438435\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022To judge whether our model is any good, it\u0027d be helpful to have a baseline. In the cell below, we calculate the error of a couple dumb baselines: always predicting the global average rating, and predicting the average rating per movie:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u002224e1226b8ded8b9e95b880ab36083f31bd5cb2e4\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nfrom sklearn.model_selection import train_test_split\\nfrom sklearn import metrics\\n\\ndf_train, df_val = train_test_split(df, test_size=.05, random_state=1)\\n\\ndef get_metrics(y_true, y_pred):\\n    return metrics.mean_absolute_error(y_true, y_pred), metrics.mean_squared_error(y_true, y_pred)\\n\\nmean_rating = df_train[\u0027rating\u0027].mean()\\nprint(\\\u0022Average rating in training set is {:.2f} stars\\\u0022.format(mean_rating))\\n\\ny_true = df_val[\u0027rating\u0027].values\\nalways_mean = np.full(y_true.shape, mean_rating)\\n\\nmae, mse = get_metrics(y_true, always_mean)\\nprint(\\\u0022Always predicting global average rating results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}\\\u0022.format(\\n    mae, mse))\\n\\nmovies = movies_df.copy().set_index(\u0027movieId\u0027)\\nmean_per_movie = df_train.groupby(\u0027movieId\u0027)[\u0027rating\u0027].mean()\\nmovies[\u0027mean_rating\u0027] = mean_per_movie\\nratings_per_movie = df_train.groupby(\u0027movieId\u0027).size()\\nmovies[\u0027n_ratings\u0027] = ratings_per_movie\\n# There are a few movies in the validation set not present in the training set. We\u0027ll just use the global\\n# mean rating in their case.\\ny_movie_mean = df_val.join(mean_per_movie, on=\u0027movieId\u0027, rsuffix=\u0027mean\u0027)[\u0027ratingmean\u0027].fillna(mean_rating).values\\n\\nmae, mse = get_metrics(y_true, y_movie_mean)\\nprint(\\\u0022Predicting mean per movie results in Mean Absolute Error={:.2f}, Mean Squared Error={:.2f}\\\u0022.format(mae, mse))\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00226537eaa40ec56101f79527cc58f516bdf3504382\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Here\u0027s a plot of our embedding model\u0027s absolute error over time. For comparison, our best baseline (predicting the average rating per movie) is marked with a dotted line:\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022250a4ecbf2b274ed6ba99c781a4bba962eb7167c\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nfig, ax = plt.subplots(figsize=(15, 6))\\nax.plot(history.epoch, history.history[\u0027val_mean_absolute_error\u0027], label=\u0027Validation MAE\u0027)\\nax.plot(history.epoch, history.history[\u0027mean_absolute_error\u0027], label=\u0027Training MAE\u0027)\\nax.set_xlabel(\u0027Epoch\u0027)\\nax.set_ylabel(\u0027Mean Absolute Error\u0027)\\nax.set_xlim(left=0, right=history.epoch[-1])\\nbaseline_mae = 0.73\\nax.axhline(baseline_mae, ls=\u0027--\u0027, label=\u0027Baseline\u0027, color=\u0027#002255\u0027, alpha=.5)\\nax.grid()\\nfig.legend();\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00223f5ab52d611e1514371582974a2065f937208c2c\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\n# Save training history for later comparison\\nhdf = pd.DataFrame(dict(\\n    epoch=history.epoch,\\n    val_mae=history.history[\u0027val_mean_absolute_error\u0027],\\n    train_mae=history.history[\u0027mean_absolute_error\u0027],\\n))\\nhdf.to_csv(\u0027history-1.csv\u0027)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00228f5eef91cbeaf72c3e39e8dd66d00cd2b68449b7\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Compared to the baseline, we were able to get our average error down by more than .1 stars (or about 15%). Not bad!\\n\\n## Example predictions\\n\\nLet\u0027s try some example predictions as a sanity check. We\u0027ll start by picking out a specific user from the dataset at random.\u0022},{\u0022metadata\u0022:{\u0022_kg_hide-input\u0022:true,\u0022trusted\u0022:false,\u0022_uuid\u0022:\u00229a4e4a1c144b8fbfd2aac2516ae6238f6cc2952f\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022\\nratings_per_user = df.groupby(\u0027userId\u0027).size()\\nuid = ratings_per_user[ratings_per_user \u003c 30].sample(1, random_state=1).index[0]\\nuser_ratings = df[df.userId==uid]\\nprint(\\\u0022User #{} has rated {} movies (avg. rating = {:.1f}):\\\u0022.format(\\n    uid, len(user_ratings), user_ratings[\u0027rating\u0027].mean(),\\n))\\ncols = [\u0027userId\u0027, \u0027movieId\u0027, \u0027rating\u0027, \u0027title\u0027, \u0027year\u0027]\\nuser_ratings.sort_values(by=\u0027rating\u0027, ascending=False)[cols]\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u00221410d00338aba351613406fe30043c9711007967\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022User 26556 has given out two perfect ratings to the movies *Airplane!* and *Airplane II: The Sequel*. Great choices! Perhaps they\u0027d also enjoy the [*The Naked Gun*](https://en.wikipedia.org/wiki/The_Naked_Gun) series - another series of spoof films starring Leslie Nielsen.\\n\\nWe don\u0027t have as much evidence about what this user hates. Rather than extrapolating from their few low ratings, a better indication of this user\u0027s dislikes might be the kinds of movies they haven\u0027t even rated. Let\u0027s also throw in a couple examples of movies that this user seems unlikely to ever watch, according to their rating history.\u0022},{\u0022metadata\u0022:{\u0022trusted\u0022:false,\u0022_uuid\u0022:\u0022b28e7bf92d12f4633901035f71f0451b95d0200d\u0022},\u0022cell_type\u0022:\u0022code\u0022,\u0022source\u0022:\u0022candidate_movies = movies[\\n    movies.title.str.contains(\u0027Naked Gun\u0027)\\n    | (movies.title == \u0027The Sisterhood of the Traveling Pants\u0027)\\n    | (movies.title == \u0027Lilo \u0026 Stitch\u0027)\\n].copy()\\n\\npreds = model.predict([\\n    [uid] * len(candidate_movies), # User ids \\n    candidate_movies.index, # Movie ids\\n])\\n# NB: Remember we trained on \u0027y\u0027, which was a version of the rating column centered on 0. To translate\\n# our model\u0027s output values to the original [0.5, 5] star rating scale, we need to \u0027uncenter\u0027 the\\n# values, by adding the mean back\\nrow = df.iloc[0] # The difference between rating and y will be the same for all rows, so we can just use the first\\ny_delta = row.rating - row.y\\ncandidate_movies[\u0027predicted_rating\u0027] = preds + y_delta\\n# Add a column with the difference between our predicted rating (for this user) and the movie\u0027s\\n# overall average rating across all users in the dataset.\\ncandidate_movies[\u0027delta\u0027] = candidate_movies[\u0027predicted_rating\u0027] - candidate_movies[\u0027mean_rating\u0027]\\ncandidate_movies.sort_values(by=\u0027delta\u0027, ascending=False)\u0022,\u0022execution_count\u0022:null,\u0022outputs\u0022:[]},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022af4348a1bf31d5ec17c230c117768acac3a136fc\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022Looks pretty reasonable! For each of the movies in the *The Naked Gun* series, our predicted ratings for this user are around a full star above the average rating in the dataset, and our \u0027out of left field\u0027 picks have their predicted ratings downgraded compared to average.\u0022},{\u0022metadata\u0022:{\u0022_uuid\u0022:\u0022b590532284424329076efff896d99d90ff3a3a15\u0022},\u0022cell_type\u0022:\u0022markdown\u0022,\u0022source\u0022:\u0022# Your turn!\\n\\nHead over to [the Exercises notebook](https://www.kaggle.com/kernels/fork/1598432) to get some hands-on practice working with embedding layers.\\n### P.S...\\n\\nThis course is still in beta, so I\u0027d love to get your feedback. If you have a moment to [fill out a super-short survey about this lesson](https://form.jotform.com/82826168584267), I\u0027d greatly appreciate it. You can also leave public feedback in the comments below, or on the [Learn Forum](https://www.kaggle.com/learn-forum).\\n\u0022}],\u0022metadata\u0022:{\u0022kernelspec\u0022:{\u0022display_name\u0022:\u0022Python 3\u0022,\u0022language\u0022:\u0022python\u0022,\u0022name\u0022:\u0022python3\u0022},\u0022language_info\u0022:{\u0022codemirror_mode\u0022:{\u0022name\u0022:\u0022ipython\u0022,\u0022version\u0022:3},\u0022file_extension\u0022:\u0022.py\u0022,\u0022mimetype\u0022:\u0022text/x-python\u0022,\u0022name\u0022:\u0022python\u0022,\u0022nbconvert_exporter\u0022:\u0022python\u0022,\u0022pygments_lexer\u0022:\u0022ipython3\u0022,\u0022version\u0022:\u00223.6.5\u0022},\u0022learntools_metadata\u0022:{\u0022lesson_index\u0022:0,\u0022type\u0022:\u0022tutorial\u0022}},\u0022nbformat\u0022:4,\u0022nbformat_minor\u0022:1}","dateCreated":"2018-11-08T17:35:25.3250308Z"},"resources":null,"isolatorResults":"\u003cresults\u003e\u003cdisk_kb_free\u003e4822000\u003c/disk_kb_free\u003e\u003cdocker_image_digest\u003e03c5982f9838ebb10948c16ea06ea11858efa133fae04c4fa45daf813e31d003\u003c/docker_image_digest\u003e\u003cdocker_image_id\u003esha256:ca40f19b10bfb907f50b0b9894a3bed9ef671770d0d4719034f0857bf4b7fec0\u003c/docker_image_id\u003e\u003cdocker_image_name\u003egcr.io/kaggle-images/python\u003c/docker_image_name\u003e\u003cexit_code\u003e0\u003c/exit_code\u003e\u003cfailure_message /\u003e\u003cinvalid_path_errors\u003eFalse\u003c/invalid_path_errors\u003e\u003cout_of_memory\u003eFalse\u003c/out_of_memory\u003e\u003crun_time_seconds\u003e1352.202863225\u003c/run_time_seconds\u003e\u003csucceeded\u003eTrue\u003c/succeeded\u003e\u003ctimeout_exceeded\u003eFalse\u003c/timeout_exceeded\u003e\u003cused_all_space\u003eFalse\u003c/used_all_space\u003e\u003cwas_killed\u003eFalse\u003c/was_killed\u003e\u003c/results\u003e","runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageDigest":"03c5982f9838ebb10948c16ea06ea11858efa133fae04c4fa45daf813e31d003","dockerImageId":"sha256:ca40f19b10bfb907f50b0b9894a3bed9ef671770d0d4719034f0857bf4b7fec0","dockerImageName":"kaggle/python","diskKbFree":4822000,"failureMessage":"","exitCode":0,"queuedSeconds":0,"outputSizeBytes":0,"runTimeSeconds":1352.202863225,"usedAllSpace":false,"timeoutExceeded":false,"isValidStatus":false,"wasGpuEnabled":false,"wasInternetEnabled":false,"outOfMemory":false,"invalidPathErrors":false,"succeeded":true,"wasKilled":false},"outputFilesTotalSizeBytes":340405,"dockerImageVersionId":13801,"usedCustomDockerImage":false,"dataSources":[{"sourceType":"KernelVersion","sourceId":6375455,"databundleVersionId":null,"mountSlug":""}]},"author":{"id":473824,"displayName":"ColinMorris","email":null,"editedEmail":null,"editedEmailCode":null,"userName":"colinmorris","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","profileUrl":"/colinmorris","registerDate":"0001-01-01T00:00:00Z","lastVisitDate":"0001-01-01T00:00:00Z","statusId":0,"performanceTier":3,"userRoles":null,"userLogins":null,"groupIds":null,"duplicateUsers":null,"hasPhoneVerifications":false,"failedNerdchas":0,"hasPendingNerdcha":false,"deleteRequests":null,"userAttributes":null,"isAdmin":false,"isTvc":false,"isKaggleBot":false,"isAdminOrTvc":false,"isAnonymous":false,"canAct":false,"canBeSeen":false,"thumbnailName":null,"activationCode":"00000000-0000-0000-0000-000000000000","isPhoneVerified":false},"baseUrl":"/colinmorris/embedding-layers","collaborators":{"owner":{"userId":473824,"groupId":null,"groupMemberCount":null,"profileUrl":"/colinmorris","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","name":"ColinMorris","slug":"colinmorris","userTier":3,"joinDate":null,"type":"owner","isUser":true,"isGroup":false},"collaborators":[{"userId":9028,"groupId":null,"groupMemberCount":null,"profileUrl":"/dansbecker","thumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/9028-fb.jpg","name":"DanB","slug":"dansbecker","userTier":5,"joinDate":"2018-10-11T00:09:42.387Z","type":"writer","isUser":true,"isGroup":false}]},"initialTab":null,"log":"[{\n  \u0022data\u0022: \u0022[NbConvertApp] Converting notebook script.ipynb to html\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.250501422000525\n},{\n  \u0022data\u0022: \u0022[NbConvertApp] Executing notebook with kernel: python3\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 4.291837238999506\n},{\n  \u0022data\u0022: \u0022[NbConvertApp] Support files will be in __results___files/\\n[NbConvertApp] Making directory __results___files\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 1351.4182553400005\n},{\n  \u0022data\u0022: \u0022[NbConvertApp] Writing 314117 bytes to __results__.html\\n\u0022,\n  \u0022stream_name\u0022: \u0022stderr\u0022,\n  \u0022time\u0022: 1351.4203170180008\n}]","outputFiles":[{"ownerInfo":null,"kernelVersionOutputFileId":17920473,"kernelVersionId":7193256,"kernelId":1592233,"size":0,"fullPath":"history-1.csv","previewUrl":"/kernels/preview.json/7193256/8000535a-afb5-255d-af1d-dab681524b4c/history-1.csv","downloadUrl":"https://www.kaggleusercontent.com/kf/7193256/eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..VCDD_cGLbzQRlr9OoOEkKA.aRpGs2pNZFKr_W3WbdfShfO2_tX9MbOCOxgkyarymT1F5Ow_JkHX2jMw7H3millO45ZYc8B7laYgHD1yL5DjHPU0pQRFUZBu5bTB9lRp7nVSKBCXJfOa4ZpfD-aLP8kd3q_ZnWPrKM9IWwOVGSmFQg.8fGqawxSo-IYzBqI8dJFyw/history-1.csv","fileType":".csv","contentLength":880,"contentType":null,"contentMD5":null,"validationErrors":null,"type":"kernelOutputFile","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"history-1.csv","description":null}],"outputFilesCropped":false,"ouputFilesOwnerInfo":{"databundleVersionId":0,"dataset":null,"competition":null,"kernel":{"kernelId":1592233,"kernelVersionId":7193256,"dataviewToken":"eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..Fs1YbaOWjR1SDrTtfGT7Kw.eqbd_BPH1O65tOKj5Jr-4w_Lm7t2kxHUq5YxbDpcitdmWHdLASXDKw-VRdUYzPSupsWN5-QL__-_XJFtFju_4eefswFHTo1I4qL9-qTjepTBoJy11vf673gVUQEiaXnKGbqU2yTWDN6E4to7ttfWYGSLYyXC0FNkxUnG-UbrZ55USrkS61HuhYSNdfKFcT_S18umwQHVHijDzTS7hRkdWcIf69W0H_Y4ULqXEneByRI9j-miFPxye2KCWEYpfPuKXUgzTl7ZLNEJiO9DM7tiBGI_8drHVpJBFB3ecCH3EmSFHFLj87qAcPi5QeHIK4GiLWlcyFy5I4sH8a2oqrUapHqJNIBGmOTxJSDxEgRWjcRLTs3izMnzHgVI4kqfm4S1xx2PqTB4CGD38MDgy2JBHBxLFzzLfXrrNjMJEcHE1xf_rlqPBHPLK-X_QT-BAzkovKQUEnKlhFAfkqBk8FvLNQw1TFjrDZ2cc0QKgnWeOPpzHbA8NHJTW5H1zoorqMgQTXO2cIy6lqFtUo_yxFJBBw.SaV2eumGV2Qsc97QijdkRQ","scope":"colinmorris/embedding-layers"},"previewsDisabled":false},"pageMessages":[],"dataSources":[{"imageUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","sourceUrl":"/colinmorris/movielens-preprocessing","slug":"movielens-preprocessing","lastUpdated":"2018-10-11T00:04:53.477Z","overview":null,"sourceType":"kernel","sourceVersionType":null,"sourceId":6375455,"sourceVersionNumber":null,"maxVersionNumber":null,"descriptionMimeType":null,"deleted":false,"private":false,"privateButVisible":false,"ownerInfo":{"databundleVersionId":0,"dataset":null,"competition":null,"kernel":{"kernelId":1592008,"kernelVersionId":6375455,"dataviewToken":"eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..TNaJO2bgGHvwEySsELsqng.0OYbC79-diuo2d_M0BnJgoRVGOnE7R_dOVY3d9YiDMzPcJgQUtQdehi-RTsPPitRNjeWxKxddttBRP6iGwm3ZpkxH0c23JYGPfIL1apim77ZJ9NRsmkDywEmuJFeNV6ZQAmRCV5U9BzR48-DHpNeLMy4bdl5SiBoh6-YGs0FHf7-FVZeURiOh2gzJ0xeUXUduthCIptTfZwueRzQ944sSuEWhviuYnymKMZPMRrQfTBDuiFjn9mYDvYVjxtOuNodBsF5Buz7IA-Ap5tUajNSWD0HQZjCuuxwyetOzaB-5pvK-TrqP3cpCkD_RRFn_7YY6BZc9B2vPPaSOk_12ZJ4OhnxKLr3UHx3d47ue3CpnEwILTszv2jryljGXMy_czIJwDDdIZRk_GzlV0BZdsE741AXqMsnJq2t6RCeHUZX0_d5ksS6G8FobyYEqrlKy7OWab5ydbeJGvdOoZt5qP8BvgS0ePEbRAng1x058U7mynuCgsMmYNcEvrXBlESh5wnLt8vmbDqBZIHqU9CrMCEt-cRw8f91zIZIks03AWlcv2y9ogWjYALB4kcU3NCxwuCxqLpBQIjlPbYdKe-No46j-g.9569vrDKmknBHIYpr0D9Xw","scope":"868931/movielens-preprocessing"},"previewsDisabled":false},"mountSlug":"","type":"dataSource","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[{"size":77730356,"fullPath":"../input/mini_rating.csv","previewUrl":"/kernels/preview.json/6375455/EE459E9D-2F16-BB62-A1B5-D73C8F236208/mini_rating.csv","downloadUrl":null,"fileType":"csv","contentLength":0,"contentType":null,"contentMD5":null,"validationErrors":null,"type":"file","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"mini_rating.csv","description":null},{"size":2444966,"fullPath":"../input/movie.csv","previewUrl":"/kernels/preview.json/6375455/EE459E9D-2F16-BB62-A1B5-D73C8F236208/movie.csv","downloadUrl":null,"fileType":"csv","contentLength":0,"contentType":null,"contentMD5":null,"validationErrors":null,"type":"file","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"movie.csv","description":null},{"size":697372279,"fullPath":"../input/rating.csv","previewUrl":"/kernels/preview.json/6375455/EE459E9D-2F16-BB62-A1B5-D73C8F236208/rating.csv","downloadUrl":null,"fileType":"csv","contentLength":0,"contentType":null,"contentMD5":null,"validationErrors":null,"type":"file","collapsed":false,"info":{"metrics":null,"archiveInfo":null,"archiveInfoV2":null,"blobFileInfo":null,"convertCsvInfo":null,"kernelReference":null},"settings":{"csvSettings":null,"bigQuerySettings":null,"bigQueryMirrorSettings":null,"storageSettings":null,"remoteUrlSettings":null,"remoteGithubSettings":null},"render":null,"children":[],"firestorePath":null,"firestoreKey":null,"name":"rating.csv","description":null}],"firestorePath":null,"firestoreKey":null,"name":"MovieLens Preprocessing","description":null}],"versions":[{"id":7193256,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-11-08T17:35:25.403Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":2,"linesInsertedFromPrevious":2,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:ca40f19b10bfb907f50b0b9894a3bed9ef671770d0d4719034f0857bf4b7fec0","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1352.202863225,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Embedding Layers","url":"/colinmorris/embedding-layers?scriptVersionId=7193256","versionNumber":11,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/9028-fb.jpg","displayName":"DanB","userName":"dansbecker","profileUrl":"/dansbecker","tier":"Novice","tierInt":0,"userId":9028}},{"id":6375461,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-10-11T00:05:01.94Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":1,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:92e9bd37d14ad1eb5a164f65de9830da245a7dc7e92d42ccced2d5871e31471c","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1258.75599468799,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Embedding Layers","url":"/colinmorris/embedding-layers?scriptVersionId=6375461","versionNumber":10,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":6373083,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-10-10T21:12:15.46Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":2,"linesInsertedFromPrevious":5,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:92e9bd37d14ad1eb5a164f65de9830da245a7dc7e92d42ccced2d5871e31471c","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1143.454976004,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Embedding Layers","url":"/colinmorris/embedding-layers?scriptVersionId=6373083","versionNumber":9,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":6370464,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-10-10T18:59:09.113Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":13,"linesInsertedFromPrevious":12,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:92e9bd37d14ad1eb5a164f65de9830da245a7dc7e92d42ccced2d5871e31471c","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1394.69514535801,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Embedding Layers","url":"/colinmorris/embedding-layers?scriptVersionId=6370464","versionNumber":8,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":6370053,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-10-10T18:40:42.157Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":1,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:92e9bd37d14ad1eb5a164f65de9830da245a7dc7e92d42ccced2d5871e31471c","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":15.2052023989963,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=6370053","versionNumber":7,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5668885,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-12T20:38:11.167Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":14,"linesInsertedFromPrevious":16,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1328.039126274,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5668885","versionNumber":6,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5649350,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-11T23:04:06.583Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":8,"linesInsertedFromPrevious":2,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1162.14748654899,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5649350","versionNumber":5,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5571127,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-07T21:47:41.943Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":0,"linesInsertedFromPrevious":2,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1417.94675142301,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5571127","versionNumber":4,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5553170,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-07T00:50:26.873Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":1,"linesInsertedFromPrevious":2,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":1214.668678765,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5553170","versionNumber":3,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5553007,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-07T00:34:38.323Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":6,"linesInsertedFromPrevious":6,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":19.5964140249998,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5553007","versionNumber":2,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}},{"id":5552982,"kernelVersionId":null,"isForkParent":false,"isNotebook":true,"languageName":"Python","lastRunTime":"2018-09-07T00:31:14.67Z","linesChangedFromPrevious":0,"linesDeletedFromPrevious":0,"linesInsertedFromPrevious":291,"outputFilesTotalSizeBytes":0,"runInfo":{"dockerfileUrl":"https://github.com/Kaggle/docker-python/blob/master/Dockerfile","dockerHubUrl":"https://registry.hub.docker.com/u/kaggle/python/","dockerImageId":"sha256:53b26d2bc6d9aa93b7bb9975f1a1887b5237142e673dd30b6a6cc02defbcc4af","dockerImageName":"gcr.io/kaggle-images/python","exitCode":0,"failureMessage":"","isValidStatus":true,"runTimeSeconds":9.96893089300283,"succeeded":true,"timeoutExceeded":false,"usedAllSpace":false},"status":"complete","title":"1 Embedding layers","url":"/colinmorris/embedding-layers?scriptVersionId=5552982","versionNumber":1,"hasVersionNumber":true,"isRedacted":false,"versionAuthor":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","displayName":"ColinMorris","userName":"colinmorris","profileUrl":"/colinmorris","tier":"Novice","tierInt":0,"userId":473824}}],"categories":{"categories":[],"type":"script"},"submitToCompetitionInfo":null,"downloadAllFilesUrl":"/kernels/svzip/7193256","submission":null,"menuLinks":[{"href":"/colinmorris/embedding-layers/notebook","text":"Notebook","title":"Notebook","tab":"notebook","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/colinmorris/embedding-layers/code","text":"Code","title":"Code","tab":"code","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/colinmorris/embedding-layers/data","text":"Data","title":"Data","tab":"data","count":1,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/colinmorris/embedding-layers/output","text":"Output","title":"Output","tab":"output","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/colinmorris/embedding-layers/log","text":"Log","title":"Log","tab":"log","count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},{"href":"/colinmorris/embedding-layers/comments","text":"Comments","title":"Comments","tab":"comments","count":34,"showZeroCountExplicitly":true,"reportEventCategory":null,"reportEventType":null}],"rightMenuLinks":[],"callToAction":{"href":"/kernels/fork-version/7193256","text":"Fork Notebook","title":"Fork Notebook","tab":null,"count":null,"showZeroCountExplicitly":false,"reportEventCategory":null,"reportEventType":null},"voteButton":{"totalVotes":122,"hasAlreadyVotedUp":false,"hasAlreadyVotedDown":false,"canUpvote":true,"canDownvote":false,"voteUpUrl":"/kernels/vote?id=1592233","voteDownUrl":null,"voters":[{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/27886-gp.jpg","displayName":"தீனதயாளன் சந்திரகுமாரன் / Deenadayalan C","profileUrl":"/deenadayalan","tier":"Novice","tierInt":0,"userId":27886,"userName":"deenadayalan"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/64870-gr.jpg","displayName":"AK Huang","profileUrl":"/astrokuang","tier":"Novice","tierInt":0,"userId":64870,"userName":"astrokuang"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/88198-kg.jpg","displayName":"jroberayalas","profileUrl":"/jroberayalas","tier":"Contributor","tierInt":1,"userId":88198,"userName":"jroberayalas"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/98021-kg.jpg","displayName":"PJ Trainor","profileUrl":"/trainorpj","tier":"Novice","tierInt":0,"userId":98021,"userName":"trainorpj"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/124234-kg.jpg","displayName":"Oleg Melnikov","profileUrl":"/olegmelnikov","tier":"Contributor","tierInt":1,"userId":124234,"userName":"olegmelnikov"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/129554-gr.jpg","displayName":"Rafael Barbolo","profileUrl":"/barbolo","tier":"Novice","tierInt":0,"userId":129554,"userName":"barbolo"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/188941-kg.jpg","displayName":"Bcottman","profileUrl":"/bcottman","tier":"Expert","tierInt":2,"userId":188941,"userName":"bcottman"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/201481-fb.jpg","displayName":"CXQ","profileUrl":"/caoxiaoqing","tier":"Novice","tierInt":0,"userId":201481,"userName":"caoxiaoqing"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/225310-kg.jpg","displayName":"Sriram Ramanathan","profileUrl":"/sriramanathan","tier":"Contributor","tierInt":1,"userId":225310,"userName":"sriramanathan"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Donlo Wong","profileUrl":"/cfwongaf","tier":"Contributor","tierInt":1,"userId":248386,"userName":"cfwongaf"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/270510-kg.png","displayName":"Mr.Devlar","profileUrl":"/mrdevlar","tier":"Contributor","tierInt":1,"userId":270510,"userName":"mrdevlar"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/384029-kg.jpeg","displayName":"ifashion","profileUrl":"/ifashion","tier":"Contributor","tierInt":1,"userId":384029,"userName":"ifashion"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/455304-fb.jpg","displayName":"Larry","profileUrl":"/larry0220","tier":"Novice","tierInt":0,"userId":455304,"userName":"larry0220"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/458419-kg.jpg","displayName":"Avinash","profileUrl":"/avinashtum","tier":"Contributor","tierInt":1,"userId":458419,"userName":"avinashtum"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/459665-gp.jpg","displayName":"Mili Hadziomerovic","profileUrl":"/milihadziomerovic","tier":"Contributor","tierInt":1,"userId":459665,"userName":"milihadziomerovic"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/561484-kg.jpg","displayName":"Alber","profileUrl":"/alber8295","tier":"Contributor","tierInt":1,"userId":561484,"userName":"alber8295"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/573447-kg.png","displayName":"bezul","profileUrl":"/bezul2","tier":"Contributor","tierInt":1,"userId":573447,"userName":"bezul2"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/578153-kg.jpg","displayName":"Umberto","profileUrl":"/umbertogriffo","tier":"Contributor","tierInt":1,"userId":578153,"userName":"umbertogriffo"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/585010-kg.jpg","displayName":"Terry Li","profileUrl":"/terryli","tier":"Expert","tierInt":2,"userId":585010,"userName":"terryli"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Mileta","profileUrl":"/mileta1976","tier":"Contributor","tierInt":1,"userId":627288,"userName":"mileta1976"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/681829-kg.jpeg","displayName":"richarde","profileUrl":"/richarde","tier":"Expert","tierInt":2,"userId":681829,"userName":"richarde"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"little_ordinary","profileUrl":"/blacksteed","tier":"Novice","tierInt":0,"userId":721076,"userName":"blacksteed"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/815331-kg.gif","displayName":"neumann","profileUrl":"/vonneumann","tier":"Contributor","tierInt":1,"userId":815331,"userName":"vonneumann"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/824633-gr.jpg","displayName":"Thiago Melo","profileUrl":"/tmeloliveira","tier":"Novice","tierInt":0,"userId":824633,"userName":"tmeloliveira"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/841360-gr.jpg","displayName":"Ilya Shlykov","profileUrl":"/shlykov","tier":"Novice","tierInt":0,"userId":841360,"userName":"shlykov"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/856283-fb.jpg","displayName":"Calvin","profileUrl":"/calvin1","tier":"Novice","tierInt":0,"userId":856283,"userName":"calvin1"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/866788-kg.jpg","displayName":"Nick Brooks","profileUrl":"/nicapotato","tier":"Master","tierInt":3,"userId":866788,"userName":"nicapotato"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/869508-kg.png","displayName":"JJ","profileUrl":"/ljjblackpig","tier":"Contributor","tierInt":1,"userId":869508,"userName":"ljjblackpig"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Dylan","profileUrl":"/dwarner2","tier":"Novice","tierInt":0,"userId":886864,"userName":"dwarner2"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/898247-kg.jpeg","displayName":"Jianfei Wang","profileUrl":"/codlife","tier":"Expert","tierInt":2,"userId":898247,"userName":"codlife"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Adri","profileUrl":"/tita1708","tier":"Master","tierInt":3,"userId":901816,"userName":"tita1708"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/914018-kg.jpg","displayName":"Anand Vidvat","profileUrl":"/anandvidvat","tier":"Contributor","tierInt":1,"userId":914018,"userName":"anandvidvat"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"tp2422","profileUrl":"/tp2422","tier":"Contributor","tierInt":1,"userId":920441,"userName":"tp2422"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/923936-kg.png","displayName":"Michal Januszewski","profileUrl":"/meehau","tier":"Novice","tierInt":0,"userId":923936,"userName":"meehau"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/949803-kg.jpg","displayName":"Arunkumar Venkataramanan","profileUrl":"/arunkumarramanan","tier":"Master","tierInt":3,"userId":949803,"userName":"arunkumarramanan"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1032043-gr.jpg","displayName":"Christian Rivera","profileUrl":"/josuerf","tier":"Contributor","tierInt":1,"userId":1032043,"userName":"josuerf"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1049704-kg.jpg","displayName":"Uwais Iqbal","profileUrl":"/uwaisiqbal","tier":"Contributor","tierInt":1,"userId":1049704,"userName":"uwaisiqbal"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1075413-gp.jpg","displayName":"GIRISH kuniyal","profileUrl":"/girishkuniyal","tier":"Novice","tierInt":0,"userId":1075413,"userName":"girishkuniyal"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Syed Nusrath","profileUrl":"/syednusrath","tier":"Novice","tierInt":0,"userId":1088092,"userName":"syednusrath"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1098298-gr.jpg","displayName":"Shofiullah Babor","profileUrl":"/babu13f","tier":"Novice","tierInt":0,"userId":1098298,"userName":"babu13f"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1115104-kg.jpg","displayName":"Niyamat Ullah","profileUrl":"/niyamatalmass","tier":"Expert","tierInt":2,"userId":1115104,"userName":"niyamatalmass"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"DoruCuliac","profileUrl":"/the7saint","tier":"Novice","tierInt":0,"userId":1261391,"userName":"the7saint"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1281858-kg.png","displayName":"Hamish Dickson","profileUrl":"/hamishdickson","tier":"Expert","tierInt":2,"userId":1281858,"userName":"hamishdickson"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1314380-kg.JPG","displayName":"Paul Mooney","profileUrl":"/paultimothymooney","tier":"Staff","tierInt":5,"userId":1314380,"userName":"paultimothymooney"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1414806-kg.jpg","displayName":"Jatin Gupta","profileUrl":"/cdsjatin","tier":"Contributor","tierInt":1,"userId":1414806,"userName":"cdsjatin"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1427069-kg.jpg","displayName":"Hiep Nguyen","profileUrl":"/nvhbk16k53","tier":"Contributor","tierInt":1,"userId":1427069,"userName":"nvhbk16k53"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1449054-kg.jpg","displayName":"Akash Ravichandran","profileUrl":"/akashravichandran","tier":"Expert","tierInt":2,"userId":1449054,"userName":"akashravichandran"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1508820-kg.png","displayName":"Nishchith K","profileUrl":"/inishchith","tier":"Contributor","tierInt":1,"userId":1508820,"userName":"inishchith"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1512152-kg.jpg","displayName":"Rosefun","profileUrl":"/rosefun","tier":"Contributor","tierInt":1,"userId":1512152,"userName":"rosefun"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1559714-kg.jpg","displayName":"Fazil T","profileUrl":"/fazilbtopal","tier":"Contributor","tierInt":1,"userId":1559714,"userName":"fazilbtopal"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"swapnil shindemeshram","profileUrl":"/swapu260","tier":"Contributor","tierInt":1,"userId":1608846,"userName":"swapu260"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1621143-kg.jpg","displayName":"Nicholas Buhagiar","profileUrl":"/nbuhagiar","tier":"Contributor","tierInt":1,"userId":1621143,"userName":"nbuhagiar"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Hansen Panjaitan","profileUrl":"/dantooine0182","tier":"Novice","tierInt":0,"userId":1654718,"userName":"dantooine0182"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1661445-gp.jpg","displayName":"Hitham AL-Aryan","profileUrl":"/haryan","tier":"Contributor","tierInt":1,"userId":1661445,"userName":"haryan"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"stariverI","profileUrl":"/stariveri","tier":"Novice","tierInt":0,"userId":1690543,"userName":"stariveri"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1786637-kg.JPG","displayName":"Baba Firas","profileUrl":"/rinnqd","tier":"Expert","tierInt":2,"userId":1786637,"userName":"rinnqd"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Frank","profileUrl":"/frankntim","tier":"Novice","tierInt":0,"userId":1792388,"userName":"frankntim"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1842645-fb.jpg","displayName":"Ginanjarn","profileUrl":"/ginanjarn","tier":"Novice","tierInt":0,"userId":1842645,"userName":"ginanjarn"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"AD6398","profileUrl":"/ad6398","tier":"Novice","tierInt":0,"userId":1850136,"userName":"ad6398"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1869461-fb.jpg","displayName":"Junya Kokami","profileUrl":"/jkokami","tier":"Contributor","tierInt":1,"userId":1869461,"userName":"jkokami"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1873860-kg.jpeg","displayName":"Rupa Lahiri","profileUrl":"/rblcoder","tier":"Contributor","tierInt":1,"userId":1873860,"userName":"rblcoder"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"muhammadali","profileUrl":"/malims","tier":"Novice","tierInt":0,"userId":1885190,"userName":"malims"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1892767-kg.jpg","displayName":"Ritwik Biswas","profileUrl":"/ritwikbiswas","tier":"Contributor","tierInt":1,"userId":1892767,"userName":"ritwikbiswas"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1930894-kg.JPG","displayName":"Eik Schüle","profileUrl":"/rappenlager","tier":"Contributor","tierInt":1,"userId":1930894,"userName":"rappenlager"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1932875-kg.jpg","displayName":"FāKă","profileUrl":"/wunian12138","tier":"Contributor","tierInt":1,"userId":1932875,"userName":"wunian12138"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/1992591-kg.jpg","displayName":"Marina","profileUrl":"/marinaantonova","tier":"Contributor","tierInt":1,"userId":1992591,"userName":"marinaantonova"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"dsanusha11","profileUrl":"/dsanusha11","tier":"Novice","tierInt":0,"userId":2015865,"userName":"dsanusha11"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"kepang wu","profileUrl":"/cigarnn","tier":"Novice","tierInt":0,"userId":2024631,"userName":"cigarnn"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2066075-kg.png","displayName":"Valerie Hanoka","profileUrl":"/fraxoe","tier":"Contributor","tierInt":1,"userId":2066075,"userName":"fraxoe"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2078016-kg.jpg","displayName":"Charlie","profileUrl":"/xdyangx","tier":"Contributor","tierInt":1,"userId":2078016,"userName":"xdyangx"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Kamelstats","profileUrl":"/kamstats","tier":"Contributor","tierInt":1,"userId":2096431,"userName":"kamstats"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2099384-kg.png","displayName":"bilbot75","profileUrl":"/bilbot75","tier":"Novice","tierInt":0,"userId":2099384,"userName":"bilbot75"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2142553-gp.jpg","displayName":"Alireza Mahmoudi","profileUrl":"/alir3za97","tier":"Contributor","tierInt":1,"userId":2142553,"userName":"alir3za97"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2143949-kg.png","displayName":"Krapal","profileUrl":"/krapal","tier":"Contributor","tierInt":1,"userId":2143949,"userName":"krapal"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"jhs.tw","profileUrl":"/jhs224","tier":"Novice","tierInt":0,"userId":2178835,"userName":"jhs224"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2180983-kg.jpg","displayName":"Romain","profileUrl":"/romain13","tier":"Contributor","tierInt":1,"userId":2180983,"userName":"romain13"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2204843-kg.jpg","displayName":"walker","profileUrl":"/njdxxl","tier":"Contributor","tierInt":1,"userId":2204843,"userName":"njdxxl"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2209373-kg.jpg","displayName":"bossam","profileUrl":"/bossam","tier":"Contributor","tierInt":1,"userId":2209373,"userName":"bossam"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Nils","profileUrl":"/nilsfed","tier":"Contributor","tierInt":1,"userId":2220859,"userName":"nilsfed"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"ssh","profileUrl":"/sshimizu2","tier":"Contributor","tierInt":1,"userId":2222862,"userName":"sshimizu2"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2230818-kg.jpg","displayName":"Nicolas Taylor","profileUrl":"/lockeza","tier":"Contributor","tierInt":1,"userId":2230818,"userName":"lockeza"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"VankXu","profileUrl":"/vankxu","tier":"Novice","tierInt":0,"userId":2263398,"userName":"vankxu"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2266327-kg.jpg","displayName":"Jean-Marc","profileUrl":"/dkmerona","tier":"Contributor","tierInt":1,"userId":2266327,"userName":"dkmerona"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2268710-kg.jpg","displayName":"william wang","profileUrl":"/williamwangzp","tier":"Novice","tierInt":0,"userId":2268710,"userName":"williamwangzp"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2295085-gp.jpg","displayName":"Freya","profileUrl":"/mizume","tier":"Novice","tierInt":0,"userId":2295085,"userName":"mizume"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2305621-kg.jpg","displayName":"xa68","profileUrl":"/xa7568","tier":"Novice","tierInt":0,"userId":2305621,"userName":"xa7568"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Partha ","profileUrl":"/partham","tier":"Contributor","tierInt":1,"userId":2308010,"userName":"partham"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2337501-kg.jpg","displayName":"Henry Schroy","profileUrl":"/hschroy","tier":"Contributor","tierInt":1,"userId":2337501,"userName":"hschroy"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"xiang xiuhai","profileUrl":"/xiangxh198636","tier":"Novice","tierInt":0,"userId":2387137,"userName":"xiangxh198636"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2407761-kg.jpg","displayName":"Alexander Chernyshev","profileUrl":"/yustasalex","tier":"Contributor","tierInt":1,"userId":2407761,"userName":"yustasalex"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2437876-gp.jpg","displayName":"Sandordude","profileUrl":"/sandordude","tier":"Novice","tierInt":0,"userId":2437876,"userName":"sandordude"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2440476-kg.jpeg","displayName":"Pierre-Nicolas Piquin","profileUrl":"/pierrenicolaspiquin","tier":"Contributor","tierInt":1,"userId":2440476,"userName":"pierrenicolaspiquin"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Larry Schirmer","profileUrl":"/larryschirmer","tier":"Novice","tierInt":0,"userId":2445004,"userName":"larryschirmer"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2469689-kg.png","displayName":"Cesc Canet","profileUrl":"/canetcesc","tier":"Contributor","tierInt":1,"userId":2469689,"userName":"canetcesc"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2524628-gr.jpg","displayName":"TerrorTim","profileUrl":"/timjonker","tier":"Novice","tierInt":0,"userId":2524628,"userName":"timjonker"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2525172-gp.jpg","displayName":"Henrique Dezani","profileUrl":"/henriquedezani","tier":"Novice","tierInt":0,"userId":2525172,"userName":"henriquedezani"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Asmaa Rassil","profileUrl":"/rassil","tier":"Novice","tierInt":0,"userId":2608213,"userName":"rassil"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Dave","profileUrl":"/b3astly","tier":"Novice","tierInt":0,"userId":2611530,"userName":"b3astly"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2654776-gp.jpg","displayName":"Andrei Petrovici","profileUrl":"/andreipetrovici","tier":"Novice","tierInt":0,"userId":2654776,"userName":"andreipetrovici"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Slavi Slavchev","profileUrl":"/slavislavchev","tier":"Novice","tierInt":0,"userId":2657893,"userName":"slavislavchev"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Markus Kähäri","profileUrl":"/mkahari","tier":"Novice","tierInt":0,"userId":2671488,"userName":"mkahari"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"FelixDelgado","profileUrl":"/fdelgadom","tier":"Novice","tierInt":0,"userId":2681845,"userName":"fdelgadom"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Gabriel Charão","profileUrl":"/gcharao16","tier":"Novice","tierInt":0,"userId":2684458,"userName":"gcharao16"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Yinxuan Feng","profileUrl":"/harryfyx","tier":"Novice","tierInt":0,"userId":2767419,"userName":"harryfyx"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"somsak K.","profileUrl":"/bluesky007","tier":"Novice","tierInt":0,"userId":2780884,"userName":"bluesky007"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2781653-gp.jpg","displayName":"Michele Corradi","profileUrl":"/faraone1972","tier":"Novice","tierInt":0,"userId":2781653,"userName":"faraone1972"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"xu-yaokun","profileUrl":"/xuyaokun98","tier":"Novice","tierInt":0,"userId":2869161,"userName":"xuyaokun98"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Ganesh MD","profileUrl":"/ganeshmd","tier":"Contributor","tierInt":1,"userId":2869675,"userName":"ganeshmd"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/2949675-fb.jpg","displayName":"John Dillenger","profileUrl":"/thorincode","tier":"Novice","tierInt":0,"userId":2949675,"userName":"thorincode"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Popov","profileUrl":"/celpov","tier":"Novice","tierInt":0,"userId":3149866,"userName":"celpov"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"MParrott","profileUrl":"/mp3675","tier":"Novice","tierInt":0,"userId":3207482,"userName":"mp3675"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/3241599-kg.png","displayName":"Malik Hussinov","profileUrl":"/korovai","tier":"Novice","tierInt":0,"userId":3241599,"userName":"korovai"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Aurora","profileUrl":"/aurorav","tier":"Novice","tierInt":0,"userId":3267039,"userName":"aurorav"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/3271364-kg.jpg","displayName":"Jonathan Nicholas","profileUrl":"/jojonicho","tier":"Contributor","tierInt":1,"userId":3271364,"userName":"jojonicho"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"heedhe","profileUrl":"/heedhe","tier":"Novice","tierInt":0,"userId":3278145,"userName":"heedhe"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/3288014-kg.jpg","displayName":"Cristian Coldea","profileUrl":"/crklausenburg","tier":"Contributor","tierInt":1,"userId":3288014,"userName":"crklausenburg"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"anusha ","profileUrl":"/anshakamath","tier":"Novice","tierInt":0,"userId":3294321,"userName":"anshakamath"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Esther Lee","profileUrl":"/esther0204","tier":"Novice","tierInt":0,"userId":3342796,"userName":"esther0204"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Anastasia","profileUrl":"/alieksia","tier":"Novice","tierInt":0,"userId":3400277,"userName":"alieksia"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/3432468-kg.jpg","displayName":"Bruno FERGANI","profileUrl":"/djbrunix","tier":"Novice","tierInt":0,"userId":3432468,"userName":"djbrunix"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"neeha","profileUrl":"/neeha1","tier":"Novice","tierInt":0,"userId":3447565,"userName":"neeha1"},{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/default-thumb.png","displayName":"Michael Eck","profileUrl":"/meck09","tier":"Novice","tierInt":0,"userId":3468272,"userName":"meck09"}],"currentUserInfo":{"avatarThumbnailUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/868931-kg.jpg","displayName":"folaraz","userName":"folaraz","profileUrl":"/folaraz","tier":"Contributor","tierInt":1,"userId":868931},"showVoters":true,"alwaysShowVoters":true},"parentDataSource":null,"parentName":"MovieLens Preprocessing","parentUrl":"/colinmorris/movielens-preprocessing","thumbnailImageUrl":"https://storage.googleapis.com/kaggle-avatars/thumbnails/473824-kg.jpg","canWrite":false,"canAdminister":false,"datasetHidden":false,"forkParentIsRedacted":false,"forkDiffLinesChanged":0,"forkDiffLinesDeleted":0,"forkDiffLinesInserted":0,"forkDiffUrl":null,"forkParentAuthorDisplayName":null,"forkParentAuthorUrl":null,"forkParentTitle":null,"forkParentUrl":null,"canSeeDataExplorerV2":true,"canSeeRevampedViewer":true,"canSeeInnerTableOfContents":true,"simplifiedViewer":true,"kernelOutputDataset":null});performance && performance.mark && performance.mark("KernelViewer.componentCouldBootstrap");</script>

<form action="https://www.kaggle.com/colinmorris/embedding-layers" id="__AjaxAntiForgeryForm" method="post"><input name="X-XSRF-TOKEN" type="hidden" value="CfDJ8LdUzqlsSWBPr4Ce3rb9VL9M-ve_XbYjPk_M6IhPg1o82fPPEhTEgh6TkLyXigddANkESb1h0zFvysbIXeRX5Ik8h3V3BOqtFeywVc-Yjs0gwqOF-JOABiDiUx5bT9AsfN5NFW4pg9vhwp9zMdqPgstOXVtmayi4v5F9bVjTiF0HyrkzDKpmW5f72Soid6wjVQ"></form>

<script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["STIX", "TeX"],
            linebreaks: {
                automatic: true
            },
            EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
        },
        tex2jax: {
            inlineMath: [["\\(", "\\)"], ["\\\\(", "\\\\)"]],
            displayMath: [["$$", "$$"], ["\\[", "\\]"]],
            processEscapes: true,
            ignoreClass: "tex2jax_ignore|dno"
        },
        TeX: {
            noUndefined: {
                attributes: {
                    mathcolor: "red",
                    mathbackground: "#FFEEEE",
                    mathsize: "90%"
                }
            }
        },
        Macros: {
            href: "{}"
        },
        skipStartupTypeset: true,
        messageStyle: "none"
    });
</script>
<script type="text/javascript" async="" crossorigin="anonymous" src="./Embedding Layers _ Kaggle_files/MathJax.js"></script>



    </div>

        <div class="site-layout__footer">
            <footer class="site-footer">
    <div class="site-footer__content">
        <div class="site-footer__copyright">
            <span>© 2019 Kaggle Inc</span>
        </div>
        <nav class="site-footer__nav">
            <a href="https://www.kaggle.com/team">Our Team</a>
            <a href="https://www.kaggle.com/terms">Terms</a>
            <a href="https://www.kaggle.com/privacy">Privacy</a>
            <a href="https://www.kaggle.com/contact">Contact/Support</a>
        </nav>
        <nav class="site-footer__social">
            <div data-component-name="SocialIcons" style="display: flex; flex-direction: column; flex: 1 0 auto;"><div style="--mdc-theme-on-primary:#fff; --mdc-theme-on-surface:rgba(0, 0, 0, 0.87); --mdc-theme-text-primary-on-background:rgba(0, 0, 0, 0.87); --mdc-theme-text-secondary-on-background:rgba(0, 0, 0, 0.54); --mdc-theme-text-hint-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-disabled-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-text-icon-on-background:rgba(0, 0, 0, 0.38); --mdc-theme-primary:#20BEFF; --mdc-theme-error:#F58B8A; --mdc-theme-background:#F8F8F8; --mdc-theme-surface:#F8F8F8; --mdc-theme-primary-bg:#20BEFF; --mdc-theme-secondary-bg:#919294;"><div class="social-icons"><a class="social-icons__link" href="https://www.youtube.com/kaggle" title="Follow Kaggle on YouTube"><i class="fa fa-youtube-square"></i></a><a class="social-icons__link" href="http://www.twitter.com/kaggle" title="Follow Kaggle on Twitter"><i class="fa fa-twitter-square"></i></a><a class="social-icons__link" href="http://www.facebook.com/kaggle" title="Follow Kaggle on Facebook"><i class="fa fa-facebook-square"></i></a><a class="social-icons__link" href="http://www.linkedin.com/company/kaggle" title="Follow Kaggle on LinkedIn"><i class="fa fa-linkedin-square"></i></a></div></div></div><script>var Kaggle=window.Kaggle||{};Kaggle.State=Kaggle.State||[];Kaggle.State.push();performance && performance.mark && performance.mark("SocialIcons.componentCouldBootstrap");</script>
        </nav>
    </div>
</footer>

        </div>
</div>



    <!-- Cheers, web-55955cf5b6-ms2nbp. -->

    </main>


<iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important;" aria-hidden="true" tabindex="-1" src="./Embedding Layers _ Kaggle_files/saved_resource.html"></iframe><div id="intercom-css-container"><style data-emotion="intercom-global"></style></div><div id="intercom-container" class="intercom-namespace"><style>html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body,html.intercom-modal-open,#intercom-container-body{overflow:hidden !important;}html.intercom-mobile-messenger-active,html.intercom-mobile-messenger-active > body{position:static !important;}html.intercom-mobile-messenger-active > body{height:0 !important;margin:0 !important;}iframe#intercom-frame{position:absolute !important;opacity:0 !important;width:1px !important;height:1px !important;top:0 !important;left:0 !important;border:none !important;display:block !important;z-index:-1 !important;}</style><div class="intercom-app" aria-live="polite"><div id="intercom-modal-container"></div></div></div></body></html>